{"files":[{"id":"abc942f1-1c0f-4715-9312-ae9196657b26","name":"Code","type":"server_js","source":"var spreadsheetURL;\nvar accountss \u003d SpreadsheetApp.openByUrl(\u0027https://docs.google.com/spreadsheets/d/1svXwnhaPbj0RMUY2EDADqy17XM9zQ17NWsgp4MPjEmI/edit\u0027);\nvar sheet;\nvar ads \u003d true;\nvar weekrange;\nvar weekstart;\nvar weekend;\nvar weekcycling;\nvar weekwalking;\nvar weektotal;\n\nfunction doGet(request) {\n  spreadsheetURL \u003d \"https://docs.google.com/spreadsheets/d/\"+request.parameters.spreadsheet+\"/edit\";\n  \n  if(request.parameters.spreadsheet !\u003d \"\")\n  {\n    ss \u003d SpreadsheetApp.openByUrl(spreadsheetURL);\n    sheet \u003d ss.getSheets()[2];\n  }\n  return HtmlService.createTemplateFromFile(\u0027index\u0027)\n      .evaluate()\n      .setSandboxMode(HtmlService.SandboxMode.IFRAME);\n}\n\nfunction include(filename) {\n  return HtmlService.createHtmlOutputFromFile(filename)\n      .setSandboxMode(HtmlService.SandboxMode.IFRAME)\n      .getContent();\n}\n\n//Description : Function that get spreadsheet data for the specified account\n//parameter : the account name\n// return : the url of the spreadsheet\nfunction GetSpeadsheet(account){\n  var sheet \u003d accountss.getSheets()[0];\n  var datalength \u003d parseInt(sheet.getRange(\"G2\").getValues()[0]);\n  \n  var data \u003d sheet.getRange(\"A2:E\"+(datalength+1)).getValues();\n  \n  var spreadsheet \u003d \"\";\n  \n  for(var i \u003d 0 ; i \u003c datalength; i++){\n    Logger.log(data[i][0]);\n    if(data[i][0]\u003d\u003daccount)\n    {\n      spreadsheet \u003d data[i][4];\n      if(data[i][3]\u003d\u003d\"no ads\")\n      {\n        ads\u003dfalse;\n      }\n      break;\n    }\n  }\n \n  Logger.log(ads);\n  Logger.log(spreadsheet);\n  \n  var spreadsheetURL\u003d\"\";\n  \n  if(spreadsheet!\u003d\"\")\n  {\n     spreadsheetURL \u003d \"https://docs.google.com/spreadsheets/d/\"+spreadsheet+\"/edit\";\n  }\n  \n  return spreadsheetURL;\n}\n\n//Description : Get if ads are to be displayed\n//return : true if displayed, false otherwise\nfunction DisplayAds(){\n  return ads;\n}\n\n//Description : Function that get at once all data in the recap page of a spreadsheet. \n//All data are transformed into a csv string in order to get those data all at once in javascript.\n//this permits to minimize access on server side and improve drastically access speed of datas.\n//Return : a csv string that contains all the recap data.\nfunction GetRecapData(spreadsheet)\n{ \n  var ss \u003d SpreadsheetApp.openByUrl(spreadsheet);\n  var sheet \u003d ss.getSheets()[0];\n  \n  recaprange \u003d sheet.getRange(\"C2:I23\");\n  \n  var dataarray \u003d recaprange.getValues();\n  \n  var todaydatastring \u003d dataarray[2][0] + \";\" + dataarray[2][1] + \";\" + dataarray[2][2];\n  var laststagedatastring \u003d dataarray[0][6];\n  var nextstagedatastring \u003d dataarray[2][6] + \";\" + dataarray[3][6] + \";\" + Utilities.formatDate(dataarray[4][6], ss.getSpreadsheetTimeZone(), \"dd/MM/yyyy\");\n  var startdatastring \u003d dataarray[6][6] + \";\" + Utilities.formatDate(dataarray[8][6], ss.getSpreadsheetTimeZone(), \"dd/MM/yyyy\") + \";\" + Utilities.formatDate(dataarray[9][6], ss.getSpreadsheetTimeZone(), \"dd/MM/yyyy\");\n  var latlongdatastring \u003d dataarray[11][6] + \";\" + dataarray[12][6];\n  var prevlatlongdatastring \u003d dataarray[13][6] + \";\" + dataarray[14][6];\n  \n  var altitude \u003d Maps.newElevationSampler().sampleLocation(dataarray[11][6], dataarray[12][6]);\n  altitude \u003d altitude.results[0].elevation;\n  //var altitude \u003d 0;\n  \n  var destinationnumberstring \u003d dataarray[1][6];\n  \n  var recapdatastring \u003d todaydatastring + \";\" + laststagedatastring + \";\" + nextstagedatastring + \";\" + startdatastring + \";\" + latlongdatastring + \";\" + altitude;\n  \n  //put into string monthlydata\n  var i \u003d0;\n  var j \u003d0;\n  var monthlydata \u003d \"\";\n  for(i \u003d 0 ; i\u003c 12 ; i++)\n  {\n    for(j \u003d 0 ; j \u003c3 ; j++)\n    {\n      monthlydata \u003d monthlydata + dataarray[i+10][j] + \";\" ;\n    }\n  }\n  \n  recapdatastring \u003d recapdatastring + \";\" + monthlydata + destinationnumberstring + \";\" + prevlatlongdatastring; // already ;\n  \n  return recapdatastring;\n}\n\n//Description : Find the current week number of the challenge we are currently in.\nfunction GetCurrentWeek(spreadsheet)\n{\n  var ss \u003d SpreadsheetApp.openByUrl(spreadsheet);\n  var currentDate \u003d new Date();\n  \n  var Found \u003d false;\n  var week \u003d 2;\n  \n  var sheet \u003d ss.getSheets()[2];\n  \n  while((!Found)\u0026\u0026(week\u003c\u003d128))\n  {\n    //Get Week Start\n    var weekstring \u003d week + \"\"; \n    var cellstartweek \u003d \"B\"+weekstring;\n    var cellendweek \u003d \"C\"+weekstring;\n    \n    var temprange \u003d \"A\"+weekstring+\":F\"+weekstring;\n    \n    weekrange \u003d sheet.getRange(temprange);\n    \n    var cell1 \u003d weekrange.getCell(1, 2);\n    var cell2 \u003d weekrange.getCell(1, 3);\n    \n    if((currentDate\u003e\u003dcell1.getValue()) \u0026\u0026 (currentDate\u003c\u003dcell2.getValue()))\n    {\n      Found \u003d true;\n    }\n    else\n    {\n      Found \u003d false;\n    }\n    week \u003d week+1\n  }\n  \n  week \u003d week-2;\n\n  return week;\n}\n\n//Description : Get at once the data for a specified week of the challenge\n//using cache for efficiency\n//Return : a csv string that contains all week datas.\nfunction GetWeekData2(number, spreadsheet)\n{  \n  var weeksheetdata \u003d \"\";\n  var ss \u003d SpreadsheetApp.openByUrl(spreadsheet);\n  \n  //check if data in cache\n  var cache \u003d CacheService.getPublicCache();\n  var cached \u003d cache.get(\"weeksheetcontent\");\n  if (cached \u003d\u003d null) {\n    //get content\n    \n    var sheet \u003d ss.getSheets()[2]; \n    weeksheetdata \u003d sheet.getRange(\"A2:F128\").getValues();\n    cache.put(\"weeksheetcontent\", weeksheetdata, 1500); // cache for 25 minutes\n    number\u003d number-1;\n  }\n  else\n  {\n    //get string comma separated\n    weeksheetdata \u003d cached;\n    //transform to array\n    var weeksheetarray1dim \u003d weeksheetdata.split(\",\");\n    var weeksheetarray2dim \u003d [];\n    var j\u003d0;\n    var k\u003d0;\n    \n    weeksheetarray2dim[j]\u003d[];\n    \n    for(var i\u003d0 ;i\u003c128 ; i++)\n    {\n      if(i%6 \u003d\u003d 0)\n      {\n        j++;\n        weeksheetarray2dim[j]\u003d[];\n        k\u003d0;\n      }\n      else\n      {\n        k++;\n      }\n      weeksheetarray2dim[j][k]\u003dweeksheetarray1dim[i];\n    }\n    weeksheetdata \u003d weeksheetarray2dim;\n  }\n  \n  //get today\u0027s date\n  var currentDate \u003d new Date();\n  \n  //Get Week Start\n  var week \u003d number;\n  \n  var weekdataarray \u003d weeksheetdata[week];\n  \n  //Logger.log(weeksheetdata);\n  \n  //Format week dates\n  var weeklabel \u003d \"\";\n  \n  var tempstartdate \u003dnew Date(weekdataarray[1]);\n  var tempenddate \u003dnew Date(weekdataarray[2]);\n  \n  \n  if((currentDate\u003e\u003dtempstartdate) \u0026\u0026 (currentDate\u003c\u003dtempenddate))\n  {\n    weeklabel \u003d \"Current week\";\n  }\n  else\n  {\n    var formatteddatestartweek \u003d Utilities.formatDate(tempstartdate, ss.getSpreadsheetTimeZone(), \"dd/MM/yyyy\");  \n    var formatteddateendweek \u003d Utilities.formatDate(tempenddate, ss.getSpreadsheetTimeZone(), \"dd/MM/yyyy\");\n    weeklabel \u003d \"From \"+formatteddatestartweek+\" to \"+formatteddateendweek;\n  }\n  \n  //create output string of data\n  var weekdatastring \u003d weekdataarray[0]+\";\"+weeklabel+\";\"+(Math.round(weekdataarray[3]*100)/100)+\";\"+(Math.round(weekdataarray[4]*100)/100)+\";\"+(Math.round(weekdataarray[5]*100)/100);\n  \n  return weekdatastring;\n}\n\n//Description : add in a spreadsheet a new data log\nfunction LogData(cyclingdata, walkingdata, swimmingdata, spreadsheet)\n{\n  var ss \u003d SpreadsheetApp.openByUrl(spreadsheet);\n  var sheet \u003d ss.getSheets()[4];\n  var rowcontents \u003d [new Date(),parseFloat(cyclingdata),parseFloat(walkingdata)];\n  \n  sheet.appendRow(rowcontents);\n  \n  //Clear current cache\n  ClearCache();\n}\n\n//Description : Clear the cached data for all weeks.\nfunction ClearCache()\n{\n  //clearcache\n  var cache \u003d CacheService.getPublicCache();\n  cache.remove(\"weeksheetcontent\");\n}\n\n//Description : Get map URL of map to display on the user page\n//Parameters : a string representing a location. ie. \"St John\u0027s, newfoundland\"\n//Return : Url of a map corresponding to location.\nfunction GetMapUrl(location){\n var map \u003d Maps.newStaticMap().setCenter(location);\n  map.setSize(600, 400);\n  map.addMarker(location);\n  map.setZoom(8.0);\n  map.setMapType(Maps.StaticMap.Type.HYBRID);\n Logger.log(map.getMapUrl()); \n return map.getMapUrl();\n}\n\n//Description : format latitude value in degree into format degree°Minutes\u0027Seconds\" Cardinal\n//Parameter : Latitude in degrees\n//Return : formatted string\nfunction convertLatDMS( dd ) {\n       \n        var convertdd \u003d Math.abs(dd);\n        var Deg \u003d Math.floor(convertdd);\n\n        var Min \u003d Math.floor((convertdd - Deg) * 60);\n        var Sec \u003d Math.floor((convertdd - Deg - (Min/60))*3600);\n        var Cardinal \u003d ((dd \u003e 0) ? \"N\" : \"S\");\n         \n        return Deg+\"°\"+Min+\"\\\u0027\"+Sec+\"\\\" \"+Cardinal;\n}\n\n//Description : format longitude value in degree into format degree°Minutes\u0027Seconds\" Cardinal\n//Parameter : Longitude in degrees\n//Return : formatted string\nfunction convertLonDMS( dd ) {\n       \n        var convertdd \u003d Math.abs(dd);\n        var Deg \u003d Math.floor(convertdd);\n\n        var Min \u003d Math.floor((convertdd - Deg) * 60);\n        var Sec \u003d Math.floor((convertdd - Deg - (Min/60))*3600);\n        var Cardinal \u003d ((dd \u003e 0) ? \"E\" : \"W\");\n         \n        return Deg+\"°\"+Min+\"\\\u0027\"+Sec+\"\\\" \"+Cardinal;\n}\n\n\n"},{"id":"2bbb5f4f-f978-48b2-819f-b8b426a302a2","name":"index","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml\u003e\n\u003chead\u003e\n\u003c?!\u003d include(\u0027stylesheet\u0027); ?\u003e\n\u003cscript src\u003d\"http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js\"\u003e\u003c/script\u003e\n\u003cscript src\u003d\"https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js\"\u003e\u003c/script\u003e\n\u003cscript src\u003d\"https://maps.googleapis.com/maps/api/js?v\u003d3.exp\u0026signed_in\u003dtrue\u0026libraries\u003dvisualization\"\u003e\u003c/script\u003e\n\u003cscript type\u003d\u0027text/javascript\u0027\u003e\ngoogletag.pubads().collapseEmptyDivs(true);\n\u003c/script\u003e\n\n\u003c/head\u003e\n\u003c? \n\n//clear cache from the previous visit in order to get most updated data\nClearCache();\n\nvar displayads \u003d DisplayAds();\n\nvar week \u003d GetCurrentWeek(spreadsheetURL);\nvar recapdata \u003d GetRecapData(spreadsheetURL);\n\n//Data are store as csv string.\nvar recaparray \u003d recapdata.split(\";\");\n\nvar lastStage \u003d recaparray[3]; //not used\nvar nextStage \u003d recaparray[4];\n\nvar nextStageDistance \u003d recaparray[5];\n//round to two number after comma.\nnextStageDistance \u003d parseFloat(nextStageDistance); \nnextStageDistance \u003d (Math.round(nextStageDistance*100) / 100)+ \" Km\";\nvar nextStageArrival \u003d recaparray[6];\nvar estimatedfinalarrival \u003d recaparray[9];\nvar averagespeed \u003d recaparray[7];\n//round value\naveragespeed \u003d parseFloat(averagespeed);\naveragespeed \u003d Math.round(averagespeed*100) / 100;\n\nvar latitude \u003d convertLatDMS(parseFloat(recaparray[10]));\nvar longitude \u003d convertLonDMS(parseFloat(recaparray[11]));\nvar altitude \u003d recaparray[12];\n//round value\naltitude \u003d (Math.round(altitude*100) / 100) + \" m\";\n\n//today datas\nvar todayCyclingDistance \u003d recaparray[0];\nvar todayWalkingDistance \u003d recaparray[1];\nvar todayTotalDistance \u003d recaparray[2];\n\nvar destnumber \u003d parseInt(recaparray[49]);\n\n//Get weeks data\nvar data \u003d GetWeekData2(week,spreadsheetURL);\nvar dataarray \u003d data.split(\";\");\nvar weekCyclingDistance \u003d dataarray[2];\nvar weekWalkingDistance \u003d dataarray[3];\nvar weekTotalDistance \u003d dataarray[4];\n\nvar weekDates \u003d dataarray[1];\n\n//Get months data\nvar janc \u003d recaparray[13];\nvar janw \u003d recaparray[14];\nvar jans \u003d 0;\nvar jant \u003d recaparray[15];\n\nvar febc \u003d recaparray[16];\nvar febw \u003d recaparray[17];\nvar febs \u003d 0;\nvar febt \u003d recaparray[18];\n\nvar marc \u003d recaparray[19];\nvar marw \u003d recaparray[20];\nvar mars \u003d 0;\nvar mart \u003d recaparray[21];\n\nvar aprc \u003d recaparray[22];\nvar aprw \u003d recaparray[23];\nvar aprs \u003d 0;\nvar aprt \u003d recaparray[24];\n\nvar mayc \u003d recaparray[25];\nvar mayw \u003d recaparray[26];\nvar mays \u003d 0;\nvar mayt \u003d recaparray[27];\n\nvar junc \u003d recaparray[28];\nvar junw \u003d recaparray[29];\nvar juns \u003d 0;\nvar junt \u003d recaparray[30];\n\nvar julc \u003d recaparray[31];\nvar julw \u003d recaparray[32];\nvar juls \u003d 0;\nvar jult \u003d recaparray[33];\n\nvar augc \u003d recaparray[34];\nvar augw \u003d recaparray[35];\nvar augs \u003d 0;\nvar augt \u003d recaparray[36];\n\nvar sepc \u003d recaparray[37];\nvar sepw \u003d recaparray[38];\nvar seps \u003d 0;\nvar sept \u003d recaparray[39];\n\nvar octc \u003d recaparray[40];\nvar octw \u003d recaparray[41];\nvar octs \u003d 0;\nvar octt \u003d recaparray[42];\n\nvar novc \u003d recaparray[43];\nvar novw \u003d recaparray[44];\nvar novs \u003d 0;\nvar novt \u003d recaparray[45];\n\nvar decc \u003d recaparray[46];\nvar decw \u003d recaparray[47];\nvar decs \u003d 0;\nvar dect \u003d recaparray[48];\n\n//Get maps\nvar lat \u003d parseFloat(recaparray[10]);\nvar lon \u003d parseFloat(recaparray[11]);\nvar prevlat \u003d parseFloat(recaparray[50]);\nvar prevlon \u003d parseFloat(recaparray[51]);\n?\u003e\n\n\u003cbody\u003e\n\u003cscript\u003e\n//****************\n//global variables\n//****************\nvar weeknumber \u003d \u003c?\u003d week ?\u003e;\nvar spreadsheetURL \u003d \u003c?\u003d spreadsheetURL ?\u003e;\n\n//current lat lon\nvar latforurl \u003d \u003c?\u003d lat ?\u003e;\nvar lonforurl \u003d \u003c?\u003d lon ?\u003e;\n//previous waypoint lat lon\nvar prevlatforurl \u003d \u003c?\u003d prevlat ?\u003e;\nvar prevlonforurl \u003d \u003c?\u003d prevlon ?\u003e;\n \nvar escalenumber \u003d\u003c?\u003d destnumber ?\u003e; //last stop number reached\n\nvar map; //dynamic map object\nvar markers \u003d []; //list of markers on the map\n\nvar point; //a lat lon point\nvar prevpoint; // a lat lon point\nvar panorama; //panormama setted for streetview\nvar largemap \u003d false; //Variable which tell if dynamic map is large or small.\nvar largeImg \u003d false; // variable which tell which image for enlarge or dimish map is currently displayed.\n\n//Desciption : Set the current week number;\n//Parameters : week number (must be \u003e0);\nfunction SetCurrentWeekNumber(number){\n  weeknumber\u003dnumber;\n}\n\n//function to display or not an HTML element.\n//Parameters : id of the html element\nfunction ShowHideFunction(id){\n  if(document.getElementById(id).style.display \u003d\u003d\u0027none\u0027)\n  {\n    document.getElementById(id).style.display \u003d \u0027block\u0027;\n  }\n  else\n  {\n    document.getElementById(id).style.display \u003d\u0027none\u0027;\n  }\n}\n\n//Description : Get today\u0027s date in a formatted string.\n//Return : today\u0027s date as mm/dd/yyyy\nfunction GetTodayDate(){\n  var today \u003d new Date();\n  var dd \u003d today.getDate();\n  var mm \u003d today.getMonth()+1; //January is 0!\n  var yyyy \u003d today.getFullYear();\n\n  if(dd\u003c10)\n  {\n    dd\u003d\u00270\u0027+dd;\n  } \n\n  if(mm\u003c10)\n  {\n    mm\u003d\u00270\u0027+mm;\n  } \n\n  today \u003d mm+\u0027 / \u0027+dd+\u0027 / \u0027+yyyy;\n  return today;\n}\n\n//Description : Update week data in html places\n//Parameter : csv string with data about a given week inside.\nfunction updateWeek(data){\n  document.getElementById(\"debug\").innerHTML \u003d data;\n  var dataarray \u003d data.split(\";\");\n  document.getElementById(\"weekheader\").innerHTML \u003d dataarray[1];\n  document.getElementById(\"weekcycling\").innerHTML \u003d dataarray[2];\n  document.getElementById(\"weekwalking\").innerHTML \u003d dataarray[3];\n  document.getElementById(\"weektotal\").innerHTML \u003d dataarray[4];\n  onUpdatingDone(\"weekdiv\", \"waitweek\");\n}\n\n//Description : Function that display an error message in the browser popup.\n//Parameter : an error object.\nfunction onFailure(error){\n  alert(error.message);\n}\n\n//Description : Get and load previous week data\nfunction LoadLastWeek(){\n  document.getElementById(\"debug\").innerHTML \u003d weeknumber;\n  if(weeknumber\u003e1)\n  {\n    weeknumber\u003dweeknumber-1;\n    google.script.run.withSuccessHandler(updateWeek).GetWeekData2(weeknumber,spreadsheetURL);\n  }\n}\n\n//Description : Get and load next week data\nfunction LoadNextWeek(){\n  document.getElementById(\"debug\").innerHTML \u003d weeknumber;\n  if(weeknumber\u003c\u003d128)\n  {\n    weeknumber\u003dweeknumber+1;\n    google.script.run.withSuccessHandler(updateWeek).withFailureHandler(onFailure).GetWeekData2(weeknumber,spreadsheetURL);\n  }\n}\n\n//Description : Update html content with most up to date data from the recap page of the spreadsheet.\n//Parameter : the recap data in a csv format.\nfunction updateRecap(data){\n  var recaparray \u003d data.split(\";\");\n\n  document.getElementById(\"nextstage\").innerHTML \u003d recaparray[4];\n  document.getElementById(\"nextstagedistance\").innerHTML \u003d (Math.round(parseFloat(recaparray[5])*100) / 100) + \" Km\";\n  document.getElementById(\"nextstagearrival\").innerHTML \u003d recaparray[6];\n\n  //update to most upt to date data\n  latforurl \u003d parseFloat(recaparray[10]);\n  lonforurl \u003d parseFloat(recaparray[11]);\n\n  prevlatforurl \u003d parseFloat(recaparray[50]);\n  prevlonforurl \u003d parseFloat(recaparray[51]);\n\n  document.getElementById(\"latitude\").innerHTML \u003d convertLatDMS(parseFloat(recaparray[10]));\n  document.getElementById(\"longitude\").innerHTML \u003d convertLonDMS(parseFloat(recaparray[11]));\n  document.getElementById(\"altitude\").innerHTML \u003d (Math.round(parseFloat(recaparray[12])*100) / 100)+ \" m\";\n\n  document.getElementById(\"todaycycling\").innerHTML \u003d recaparray[0];\n  document.getElementById(\"todaywalking\").innerHTML \u003d recaparray[1];\n  document.getElementById(\"todaytotal\").innerHTML \u003d recaparray[2];\n\n  document.getElementById(\"estimatearrival\").innerHTML \u003d recaparray[9];\n  document.getElementById(\"averagespeed\").innerHTML \u003d (Math.round(parseFloat(recaparray[7])*100) / 100)+\" Km/day\";\n\n  //month\n  document.getElementById(\"janc\").innerHTML \u003d recaparray[13];\n  document.getElementById(\"janw\").innerHTML \u003d recaparray[14];\n  document.getElementById(\"jans\").innerHTML \u003d 0;\n  document.getElementById(\"jant\").innerHTML \u003d recaparray[15];\n\n  document.getElementById(\"febc\").innerHTML \u003d recaparray[16];\n  document.getElementById(\"febw\").innerHTML \u003d recaparray[17];\n  document.getElementById(\"febs\").innerHTML \u003d 0;\n  document.getElementById(\"febt\").innerHTML \u003d recaparray[18];\n\n  document.getElementById(\"marc\").innerHTML \u003d recaparray[19];\n  document.getElementById(\"marw\").innerHTML \u003d recaparray[20];\n  document.getElementById(\"mars\").innerHTML \u003d 0;\n  document.getElementById(\"mart\").innerHTML \u003d recaparray[21];\n\n  document.getElementById(\"aprc\").innerHTML \u003d recaparray[22];\n  document.getElementById(\"aprw\").innerHTML \u003d recaparray[23];\n  document.getElementById(\"aprs\").innerHTML \u003d 0;\n  document.getElementById(\"aprt\").innerHTML \u003d recaparray[24];\n\n  document.getElementById(\"mayc\").innerHTML \u003d recaparray[25];\n  document.getElementById(\"mayw\").innerHTML \u003d recaparray[26];\n  document.getElementById(\"mays\").innerHTML \u003d 0;\n  document.getElementById(\"mayt\").innerHTML \u003d recaparray[27];\n\n  document.getElementById(\"junc\").innerHTML \u003d recaparray[28];\n  document.getElementById(\"junw\").innerHTML \u003d recaparray[29];\n  document.getElementById(\"juns\").innerHTML \u003d 0;\n  document.getElementById(\"junt\").innerHTML \u003d recaparray[30];\n\n  document.getElementById(\"julc\").innerHTML \u003d recaparray[31];\n  document.getElementById(\"julw\").innerHTML \u003d recaparray[32];\n  document.getElementById(\"juls\").innerHTML \u003d 0;\n  document.getElementById(\"jult\").innerHTML \u003d recaparray[33];\n\n  document.getElementById(\"augc\").innerHTML \u003d recaparray[34];\n  document.getElementById(\"augw\").innerHTML \u003d recaparray[35];\n  document.getElementById(\"augs\").innerHTML \u003d 0;\n  document.getElementById(\"augt\").innerHTML \u003d recaparray[36];\n\n  document.getElementById(\"sepc\").innerHTML \u003d recaparray[37];\n  document.getElementById(\"sepw\").innerHTML \u003d recaparray[38];\n  document.getElementById(\"seps\").innerHTML \u003d 0;\n  document.getElementById(\"sept\").innerHTML \u003d recaparray[39];\n\n  document.getElementById(\"octc\").innerHTML \u003d recaparray[40];\n  document.getElementById(\"octw\").innerHTML \u003d recaparray[41];\n  document.getElementById(\"octs\").innerHTML \u003d 0;\n  document.getElementById(\"octt\").innerHTML \u003d recaparray[42];\n\n  document.getElementById(\"novc\").innerHTML \u003d recaparray[43];\n  document.getElementById(\"novw\").innerHTML \u003d recaparray[44];\n  document.getElementById(\"novs\").innerHTML \u003d 0;\n  document.getElementById(\"novt\").innerHTML \u003d recaparray[45];\n\n  document.getElementById(\"decc\").innerHTML \u003d recaparray[46];\n  document.getElementById(\"decw\").innerHTML \u003d recaparray[47];\n  document.getElementById(\"decs\").innerHTML \u003d 0;\n  document.getElementById(\"dect\").innerHTML \u003d recaparray[48];\n\n  onUpdatingDone(\"stats\", \"waitstats\");\n  \n  var tempoldescale \u003d escalenumber;\n  escalenumber\u003d parseInt(recaparray[49]);\n\n  EnableDisableGalleryOptions();\n  setImageGallery();\n  RefreshMap();\n\n  //re display updated div\n  onUpdatingDone(\"todaydiv\", \"waittoday\");\n  onUpdatingDone(\"monthdiv\", \"waitmonth\");\n\n  //new location reached\n  if(tempoldescale !\u003d escalenumber)\n  {\n    showCongratPanel(recaparray[3]);\n  }\n}\n\n//Description : Refresh weeks data\nfunction RefreshWeek(){\n  google.script.run.withFailureHandler(onFailure).withSuccessHandler(updateWeek).GetWeekData2(weeknumber,spreadsheetURL);\n}\n\n//Description : Refresh data from the web page except weeks data\nfunction RefreshRecapData(){\n  google.script.run.withFailureHandler(onFailure).withSuccessHandler(updateRecap).GetRecapData(spreadsheetURL);\n}\n\n//Description : Refresh map data\nfunction RefreshMap(){\n  var latitude \u003d latforurl;\n  var longitude \u003d lonforurl;\n\n  deleteMarkers();\n\n  if(panorama !\u003d null)\n  {\n    panorama.setVisible(false);\n  }\n\n  var coord \u003d new google.maps.LatLng(latitude, longitude);\n  map.setCenter(coord);\n  map.setZoom(10);\n  addMarker(coord);\n}\n\n//Description : Callback function to log data pressing \"enter\" key on the keyboard\nfunction enterData(event){\n  if(event.which \u003d\u003d 13 || event.keyCode \u003d\u003d 13)\n  {\n    logData();\n  }\n}\n\n//Description : add new data into the spreadsheet\nfunction logData(){\n  //get input data\n  var cyclingdata \u003d document.getElementById(\"cyclinginput\").value;\n  var walkingdata \u003d document.getElementById(\"walkinginput\").value;\n  var swimmingdata \u003d 0;\n\n  if(cyclingdata\u003d\u003dnull||cyclingdata\u003d\u003d\"\")\n  {\n    cyclingdata\u003d0;\n  }\n\n  if(walkingdata\u003d\u003dnull||walkingdata\u003d\u003d\"\")\n  {\n    walkingdata\u003d0;\n  }\n\n  //validate data here\n  var valid \u003d true;\n  var failreason \u003d \"\";\n\n  if(isNaN(cyclingdata)||isNaN(walkingdata)||isNaN(swimmingdata)){\n    valid \u003d false;\n    failreason \u003d \"Numeric values only.\";\n  }\n\n  if((cyclingdata\u003c0)||(walkingdata\u003c0)||(swimmingdata\u003c0)){\n    valid \u003d false;\n    failreason \u003d \"\u003e\u003d0 values only.\";\n  }\n\n  if((cyclingdata\u003d\u003d0)\u0026\u0026(walkingdata\u003d\u003d0)\u0026\u0026(swimmingdata\u003d\u003d0)){\n    valid \u003d false;\n    failreason \u003d \"No value to log.\";\n  }\n\n  if(!valid)\n  {\n    document.getElementById(\"msglog\").innerHTML\u003d\"Error : \"+failreason;\n    document.getElementById(\"msglog\").style.color\u003d\"red\";\n  }\n  else\n  {\n    google.script.run.LogData(cyclingdata, walkingdata, swimmingdata, spreadsheetURL);\n    document.getElementById(\"cyclinginput\").value \u003d 0;\n    document.getElementById(\"walkinginput\").value \u003d 0;\n    document.getElementById(\"msglog\").innerHTML\u003d\"Data logged !\";\n    document.getElementById(\"msglog\").style.color\u003d\"green\";\n\n    //Put waiting gif on updated data;\n    onStartUpdating(\"stats\", \"waitstats\");\n    onStartUpdating(\"todaydiv\", \"waittoday\");\n    onStartUpdating(\"weekdiv\", \"waitweek\");\n    onStartUpdating(\"monthdiv\", \"waitmonth\");\n\n    window.setTimeout(function() { RefreshRecapData(); },500);\n    RefreshWeek();\n  }\n}\n\n//Description : function that hide div and display another div instead.\n//Parameters : div to hide and div to display\nfunction onStartUpdating(div1,div2){\n  document.getElementById(div1).style.display\u003d\"none\";\n  document.getElementById(div2).style.display\u003d\"block\";\n}\n\n//Description : function that hide div and display another div instead.\n//Parameters : div to hide and div to display\nfunction onUpdatingDone(div1,div2){\n  document.getElementById(div1).style.display\u003d\"block\";\n  document.getElementById(div2).style.display\u003d\"none\";\n}\n\n//function that convert a degree latitude into format Deg°Min\u0027Sec\" Cardinal\n//Parameter 1 : latitude in degree\n//Return : a formated string in degree, minutes, seconds and orientation.\nfunction convertLatDMS( dd ){\n  var convertdd \u003d Math.abs(dd);\n  var Deg \u003d Math.floor(convertdd);\n  var Min \u003d Math.floor((convertdd - Deg) * 60);\n  var Sec \u003d Math.floor((convertdd - Deg - (Min/60))*3600);\n  var Cardinal \u003d ((dd \u003e 0) ? \"N\" : \"S\");\n  return Deg+\"°\"+Min+\"\\\u0027\"+Sec+\"\\\" \"+Cardinal;\n}\n\n//function that convert a degree longitude into format Deg°Min\u0027Sec\" Cardinal\n//Parameter 1 : longitude in degree\n//Return : a formated string in degree, minutes, seconds and orientation.\nfunction convertLonDMS( dd ) {  \n  var convertdd \u003d Math.abs(dd);\n  var Deg \u003d Math.floor(convertdd);\n  var Min \u003d Math.floor((convertdd - Deg) * 60);\n  var Sec \u003d Math.floor((convertdd - Deg - (Min/60))*3600);\n  var Cardinal \u003d ((dd \u003e 0) ? \"E\" : \"W\");       \n  return Deg+\"°\"+Min+\"\\\u0027\"+Sec+\"\\\" \"+Cardinal;\n}\n\n//Description : function that set available galleries based on current position\nfunction EnableDisableGalleryOptions(){\n  //set option\n  var options \u003d document.getElementById(\"selection\").options;\n  var i \u003d 0;\n  var length \u003d options.length;\n\n  for(i \u003d 0 ; i\u003clength ; i ++)\n  {\n    if(escalenumber \u003c i+1)\n    {\n      options[i].disabled\u003dtrue;\n    }\n    else\n    {\n      options[i].disabled\u003dfalse;\n    }\n  }\n  document.getElementById(\"selection\").selectedIndex \u003d escalenumber-1;\n}\n\n//Description : Display images corresponding to the gallery selected\n//Parameter : index of the selected gallery\n//Return : the HNL code of the images\nfunction GetGalleryFigures(index){\n  var ressourceurl \u003d \"https://0faf07634bd2d47c8375376ca598c8b63ba9dba1.googledrive.com/host/0B0SfnkeFqf8uclVTUlFFYXNxcDQ/\";\n  var imgfile \u003d \"\";\n  var imgtype \u003d \".jpg\"\n  var imgcaption \u003d \"\";\n  var imgnumber \u003d 0;\n\n  //stjohn\u0027s\n  if(index\u003d\u003d0)\n  {\n    imgfile\u003d \"stjohnimg\";\n    imgtype\u003d\".jpg\";\n    imgcaption \u003d \"St John\u0027s, Newfoundland\";\n    imgnumber\u003d4;\n  }\n  \n  //Grand Falls\n  if(index\u003d\u003d1)\n  {\n    imgfile\u003d \"grdfallsimg\";\n    imgtype\u003d\".jpg\";\n    imgcaption \u003d \"Grand Falls Windsor, Newfoundland\";\n    imgnumber\u003d3;\n  }\n  \n  //corner brook\n  if(index\u003d\u003d2)\n  {\n    imgfile\u003d \"cornerbrookimg\";\n    imgtype\u003d\".jpg\";\n    imgcaption \u003d \"Corner Brook, Newfoundland\";\n    imgnumber\u003d5;\n  }\n  \n  //generate figures\n  var imagecontent \u003d \"\";\n  \n  if(imgnumber\u003e0)\n  {\n    for(var i \u003d 1 ; i\u003c\u003dimgnumber ; i++)\n    {\n      imagecontent \u003d imagecontent + \"\u003cfigure\u003e\u003cimg src\u003d\\\"\"+ressourceurl+imgfile+i+imgtype+\"\\\" width\u003d\u0027100%\u0027/\u003e\u003cfigcaption\u003e\"+imgcaption+\"\u003c/figcaption\u003e\u003c/figure\u003e\";\n    }\n  } \n  return imagecontent;\n}\n\n//Description : Set image gallery in imagegallery div\nfunction setImageGallery()\n{\n  var selectedelement \u003d document.getElementById(\"selection\").selectedIndex;\n  \n  var gallery \u003d GetGalleryFigures(selectedelement);\n  if(gallery !\u003d \"\")\n  {\n    document.getElementById(\"imagegallery\").innerHTML \u003d gallery;\n    makeBSS(\u0027.demo1\u0027, opts);\n  }\n}\n\n//Description : hide congratulation display\nfunction hideCongratPanel(){\n  document.getElementById(\"blackfilter\").style.visibility\u003d\"hidden\";\n  document.getElementById(\"achievement\").style.visibility\u003d\"hidden\";\n}\n\n//Description : show congratulation display\nfunction showCongratPanel(location){\n  document.getElementById(\"blackfilter\").style.visibility\u003d\"visible\";\n  document.getElementById(\"achievement\").style.visibility\u003d\"visible\";\n  document.getElementById(\"reachedlocation\").innerHTML \u003d \"\u003ch2\u003e\"+location+\"\u003c/h2\u003e\";\n}\n\n//Description : callback to change icon when map is enlarged or reduced.\nfunction enlargeImg(){\n if(!largeImg)\n {\n   largeImg \u003d true;\n   document.getElementById(\"buttonEnlarge\").src \u003d \u0027http://virtualtranscanada.com/resources/arrow_2.png\u0027;\n }\n else\n {\n   largeImg\u003d false;\n   document.getElementById(\"buttonEnlarge\").src \u003d \u0027http://virtualtranscanada.com/resources/arrow_1.png\u0027;\n }\n}\n\n//Description : Callback to set map to account current position.\nvar mypos \u003d function setToMyPosition() {\n    map.setCenter(new google.maps.LatLng(latforurl, lonforurl));\n    map.setZoom(10);\n  }\n\n//Description : Callback to set map to streetview of account position.\nvar streetpos \u003d function setToMyStreetPosition() {\n  var streetViewMaxDistance \u003d 50;          \n\n  point \u003d new google.maps.LatLng(latforurl, lonforurl);\n  prevpoint \u003d new google.maps.LatLng(prevlatforurl, prevlonforurl);\n   \n  var streetViewService \u003d new google.maps.StreetViewService();\n  panorama \u003d map.getStreetView();\n\n  streetViewService.getPanoramaByLocation(point, streetViewMaxDistance, function (streetViewPanoramaData, status) {\n    if(status \u003d\u003d google.maps.StreetViewStatus.OK){\n      var oldPoint \u003d point;\n      point \u003d streetViewPanoramaData.location.latLng;\n\n      var heading \u003d google.maps.geometry.spherical.computeHeading(prevpoint,point);            \n\n      panorama.setPosition(point);\n      panorama.setPov({\n        heading: heading,\n        zoom: 1,\n        pitch: 0\n      });\n      panorama.setVisible(true);\n    }\n  });\n}  \n\n//Description : Callback to set map to overview of the transcanada\nvar globalpos \u003d function setToGlobal() {\n  map.setCenter(new google.maps.LatLng(49.886083, -90.152921));\n  if(largeImg)\n  {\n    map.setZoom(4);\n  }\n  else\n  {\n    map.setZoom(3);\n  }\n}\n\n//Description : function that create a button control for map\n//parameter :\n//  ControlDiv is the div to add the control\n//  Map is the dynamic map that will have this control\n//  text is the text on the control\n//  title is the text to display when hanging over control\n//  func is a callback function which is executed when control is clicked\nfunction Control(controlDiv, map, text, title, func) {\n  // Set CSS for the control border\n  var controlUI \u003d document.createElement(\u0027div\u0027);\n  controlUI.style.backgroundColor \u003d \u0027#fff\u0027;\n  controlUI.style.border \u003d \u00272px solid #fff\u0027;\n  controlUI.style.borderRadius \u003d \u00273px\u0027;\n  controlUI.style.boxShadow \u003d \u00270 2px 6px rgba(0,0,0,.3)\u0027;\n  controlUI.style.cursor \u003d \u0027pointer\u0027;\n  controlUI.style.marginTop \u003d \u002710px\u0027;\n  controlUI.style.marginLeft \u003d \u002710px\u0027;\n  controlUI.style.textAlign \u003d \u0027center\u0027;\n  controlUI.title \u003d title;\n  controlDiv.appendChild(controlUI);\n\n  // Set CSS for the control interior\n  var controlText \u003d document.createElement(\u0027div\u0027);\n  controlText.style.color \u003d \u0027rgb(25,25,25)\u0027;\n  controlText.style.fontFamily \u003d \u0027Roboto,Arial,sans-serif\u0027;\n  controlText.style.fontSize \u003d \u002714px\u0027;\n  controlText.style.lineHeight \u003d \u002720px\u0027;\n  controlText.style.paddingLeft \u003d \u00275px\u0027;\n  controlText.style.paddingRight \u003d \u00275px\u0027;\n  controlText.innerHTML \u003d text;\n  controlUI.appendChild(controlText);\n\n  // Setup the click event listeners: simply set the map to\n  google.maps.event.addDomListener(controlUI, \u0027click\u0027, func);\n}\n\n//Description : change img source to a black arrow\nfunction BlackArrow(){\n  if(largeImg){\n    document.getElementById(\"arrow_2_black\").style.display\u003d\"inline\";\n    document.getElementById(\"arrow_2_gray\").style.display\u003d\"none\";\n    document.getElementById(\"arrow_1_black\").style.display\u003d\"none\";\n    document.getElementById(\"arrow_1_gray\").style.display\u003d\"none\";\n  }\n  else{\n    document.getElementById(\"arrow_1_black\").style.display\u003d\"inline\";\n    document.getElementById(\"arrow_1_gray\").style.display\u003d\"none\";\n    document.getElementById(\"arrow_2_black\").style.display\u003d\"none\";\n    document.getElementById(\"arrow_2_gray\").style.display\u003d\"none\";\n  }\n}\n\n//Description : change img source to a gray arrow\nfunction GrayArrow(){\n  if(largeImg){\n    document.getElementById(\"arrow_2_black\").style.display\u003d\"none\";\n    document.getElementById(\"arrow_2_gray\").style.display\u003d\"inline\";\n    document.getElementById(\"arrow_1_black\").style.display\u003d\"none\";\n    document.getElementById(\"arrow_1_gray\").style.display\u003d\"none\";\n  }\n  else{\n    document.getElementById(\"arrow_1_black\").style.display\u003d\"none\";\n    document.getElementById(\"arrow_1_gray\").style.display\u003d\"inline\";\n    document.getElementById(\"arrow_2_black\").style.display\u003d\"none\";\n    document.getElementById(\"arrow_2_gray\").style.display\u003d\"none\";\n  }\n}\n\n//Description : function that create a control for an image for map\n//parameter :\n//  ControlDiv is the div to add the control\n//  Map is the dynamic map that will have this control\n//  html is the html code to put on the control\n//  title is the text to display when hanging over control\n//  func is a callback function which is executed when control is clicked\nfunction ControlArrow(controlDiv, map, html, title, func, funcover, funcout) {\n\n  // Set CSS for the control border\n  var controlUI \u003d document.createElement(\u0027div\u0027);\n  controlUI.style.cursor \u003d \u0027pointer\u0027;\n  controlUI.style.marginBottom \u003d \u002710px\u0027;\n  controlUI.style.marginRight \u003d \u002710px\u0027;\n  controlUI.style.textAlign \u003d \u0027center\u0027;\n  controlUI.style.width \u003d \u002732px\u0027;\n  controlUI.style.height \u003d \u002732px\u0027;\n  controlUI.title \u003d title;\n  controlUI.innerHTML \u003d html;\n  controlDiv.appendChild(controlUI);\n\n  // Setup the click event listeners: simply set the map to\n  google.maps.event.addDomListener(controlUI, \u0027click\u0027, func);\n  google.maps.event.addDomListener(controlUI, \u0027mouseover\u0027, funcover);\n  google.maps.event.addDomListener(controlUI, \u0027mouseout\u0027, funcout);\n  \n}\n\n//Description : function that init dynamic map\nfunction initialize() {\n  var fillArray \u003d [\u0027red\u0027, \u0027blue\u0027, \u0027yellow\u0027, \u0027green\u0027];\n\n  var mapOptions \u003d {\n    center: new google.maps.LatLng(\u003c?\u003d lat ?\u003e, \u003c?\u003d lon ?\u003e),\n    scaleControl: true,\n    streetViewControl: true,\n    streetViewControlOptions: {\n        position: google.maps.ControlPosition.RIGHT_CENTER\n    },\n    zoomControl: true,\n    zoomControlOptions: {\n        style: google.maps.ZoomControlStyle.DEFAULT,\n        position: google.maps.ControlPosition.RIGHT_CENTER\n    },\n    zoom: 10\n  };\n\n  map \u003d new google.maps.Map(document.getElementById(\u0027map-canvas\u0027),\n    mapOptions);\n\n  var layer \u003d new google.maps.visualization.DynamicMapsEngineLayer({\n    layerId: \u002706673056454046135537-08896501997766553811\u0027,\n    map: map,\n    suppressInfoWindows: true,\n    clickable: false\n  });\n  \n  google.maps.event.addDomListener(window, \"resize\", function() {\n   var center \u003d map.getCenter();\n   google.maps.event.trigger(map, \"resize\");\n   map.setCenter(center); \n   });\n   \n   var centerControlDiv \u003d document.createElement(\u0027div\u0027);\n   var centerControl \u003d new Control(centerControlDiv, map, \"My position\", \"Click to center map on your position\", mypos);\n   \n   var centerControl2 \u003d new Control(centerControlDiv, map, \"Street view\", \"Click to view your position on street view\", streetpos);\n   \n   var centerControl3 \u003d new Control(centerControlDiv, map, \"Overview\", \"Click to see an overview of the transCanada\", globalpos);\n   \n   var centerControlDiv2 \u003d document.createElement(\u0027div\u0027);\n   var centerControl4 \u003d new ControlArrow(centerControlDiv2, map, \"\u003cdiv id\u003d\u0027buttonEnlarge\u0027\u003e\u003cimg id\u003d\u0027arrow_1_gray\u0027 style\u003d\u0027width:32px;height:32px;\u0027 src\u003d\u0027http://virtualtranscanada.com/resources/arrow_1.png\u0027\u003e\u003cimg id\u003d\u0027arrow_1_black\u0027 style\u003d\u0027width:32px;height:32px;display:none;\u0027 src\u003d\u0027http://virtualtranscanada.com/resources/arrow_1_black.png\u0027\u003e\u003cimg id\u003d\u0027arrow_2_gray\u0027 style\u003d\u0027width:32px;height:32px;display:none;\u0027 src\u003d\u0027http://virtualtranscanada.com/resources/arrow_2.png\u0027\u003e\u003cimg id\u003d\u0027arrow_2_black\u0027 style\u003d\u0027width:32px;height:32px;display:none;\u0027 src\u003d\u0027http://virtualtranscanada.com/resources/arrow_2_black.png\u0027\u003e\u003c/div\u003e\", \"Click to enlarge or reduce the map\", enlargemap, BlackArrow, GrayArrow);\n   \n   \n   centerControlDiv.index \u003d 1;\n   map.controls[google.maps.ControlPosition.TOP_LEFT].push(centerControlDiv);\n   \n   centerControlDiv2.index \u003d 1;\n   map.controls[google.maps.ControlPosition.RIGHT_BOTTOM].push(centerControlDiv2);\n   \n   //Add kml layer on the map\n   var KmlLayer \u003d new google.maps.KmlLayer({\n     url: \u0027http://virtualtranscanada.com/resources/Transcanada.kml\u0027,\n     preserveViewport: true,\n   });\n   KmlLayer.setMap(map);\n   \n   addMarker(new google.maps.LatLng(latforurl, lonforurl));\n}\n\n//Description : Add a marker to the map and push to the array.\nfunction addMarker(location) {\n  var marker \u003d new google.maps.Marker({\n    position: location,\n    map: map\n  });\n  markers.push(marker);\n}\n\n//Description : Sets the map on all markers in the array.\nfunction setAllMap(map) {\n  for (var i \u003d 0; i \u003c markers.length; i++) {\n    markers[i].setMap(map);\n  }\n}\n\n//Description : Removes the markers from the map, but keeps them in the array.\nfunction clearMarkers() {\n  setAllMap(null);\n}\n\n//Description : Deletes all markers in the array by removing references to them.\nfunction deleteMarkers() {\n  clearMarkers();\n  markers \u003d [];\n}\n\n//Description : Callback that will toggle map size\nvar enlargemap \u003d function enlargeDiminishMap(){\n  $(\".dynamicmap\").toggleClass(\"dynamicmapchange\");\n  enlargeImg();\n}\n \n//Description : Callback function that refresh map on resize.\nfunction TriggerMapResize() { \n  document.getElementById(\"debug\").innerHTML \u003d \"In TriggerMapResize\";\n  google.maps.event.trigger(map, \"resize\");\n}\n\ngoogle.script.run.withSuccessHandler(SetCurrentWeekNumber).GetCurrentWeek(spreadsheetURL);\ngoogle.maps.event.addDomListener(window, \u0027load\u0027, initialize);\n\u003c/script\u003e\n\u003cdiv id\u003d\"blackfilter\" onclick\u003d\"hideCongratPanel()\"\u003e\u003c/div\u003e\n\u003cdiv id\u003d\"achievement\" onclick\u003d\"hideCongratPanel()\" style\u003d\"width:500px;height:300px;\"\u003e\u003cbr\u003e\u003ch1\u003eCongratulations !\u003c/h1\u003e\u003cbr\u003e\u003cp style\u003d\"text-align:center;\"\u003eYou\u0027ve just reached\u003c/p\u003e\u003cp id\u003d\"reachedlocation\" style\u003d\"text-align:center;\"\u003e\u003c/p\u003e\u003cbr\u003e\u003cp style\u003d\"width:200px;margin-left:50px;\"\u003eNew gallery unlocked.\u003c/p\u003e\u003c/div\u003e\n\u003cdiv id\u003d\"title\" \u003e\n  \u003ctable style\u003d\"width:100%\"\u003e\n  \u003ctr\u003e\n    \u003ctd\u003e\n    \u003ch2 style\u003d\"margin-left:15px;color:green;margin-top:4px;\"\u003eVirtual TransCanada Challenge\u003c/h2\u003e\n    \u003c/td\u003e\n    \u003ctd style\u003d\"text-align:right;\"\u003e\n    \u003cp style\u003d\"margin-right:15px;color:red;margin-top:4px;\"\u003eWelcome Grandlapin !\u0026nbsp;\u0026nbsp;\u0026nbsp;\u003cspan style\u003d\"color:black;text-decoration:underline;\"\u003eSettings\u003c/span\u003e\u0026nbsp;\u0026nbsp;\u0026nbsp;\u003ca href\u003d\"http://virtualtranscanada.com/main.html\" target\u003d\"_top\" style\u003d\"color:black;text-decoration:underline;\"\u003eLogout\u003c/a\u003e\u003c/p\u003e\n    \u003c/td\u003e\n  \u003c/tr\u003e\n  \u003c/table\u003e\n\u003c/div\u003e\n\u003cdiv id\u003d\"menu\"\u003e\n\u003c/div\u003e\n        \u003cdiv style\u003d\"height:45px;\"\u003e\u003c/div\u003e\n        \u003ctable id\u003d\"maintbl\"\u003e\n        \u003ctr id\u003d\"ad1\"\u003e\n          \u003ctd colspan\u003d\"3\"\u003e\n          \u003cscript async src\u003d\"//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js\"\u003e\u003c/script\u003e\n          \u003c!-- TopBanner1 --\u003e\n          \u003cins class\u003d\"adsbygoogle\"\n          style\u003d\"display:inline-block;width:728px;height:90px\"\n          data-ad-client\u003d\"ca-pub-3801664724227747\"\n          data-ad-slot\u003d\"3901527444\"\u003e\u003c/ins\u003e\n          \u003cscript\u003e\n          (adsbygoogle \u003d window.adsbygoogle || []).push({});\n          \u003c/script\u003e\n          \u003c/td\u003e\n        \u003c/tr\u003e\n        \u003ctr\u003e\n          \u003ctd colspan\u003d\"2\"\u003e\n          \u003cdiv class\u003d\"tile\"\u003e\n          \u003ctable class\u003d\"midlargetiletable\"\u003e\n          \u003ctr\u003e\n            \u003ctd\u003e\n            \u003cdiv style\u003d\"width:600px;height:332px;\"\u003e\u003cdiv id\u003d\"map-canvas\" class\u003d\"dynamicmap\"\u003e\u003c/div\u003e\u003c/div\u003e\n            \u003c/td\u003e\n          \u003c/tr\u003e\n          \u003c/table\u003e\n          \u003c/div\u003e\n          \u003c/td\u003e\n          \u003ctd rowspan\u003d\"2\"\u003e\n          \u003cdiv class\u003d\"tile\"\u003e\n          \u003cdiv class\u003d\"headerbg\" style\u003d\"width:320px;\"\u003e\u003c/div\u003e\n          \u003cdiv class\u003d\"contentbg\" style\u003d\"width:320px;height:645px;\"\u003e\u003c/div\u003e\n          \u003ctable class\u003d\"midtalltiletable\"\u003e\n          \u003ctr\u003e\n            \u003ctd\u003e\n            \u003ctable class\u003d\"catheader\"\u003e\n            \u003ctr\u003e\n              \u003ctd class\u003d\"p1\" style\u003d\"font:bold 16px verdana;\"\u003eInformation\u003c/td\u003e\n              \u003ctd class\u003d\"p1\" style\u003d\"text-align:right\"\u003e\u003ca class\u003d\"showhide\" onclick\u003d\"ShowHideFunction(\u0027stats\u0027)\"\u003eShow/Hide\u003c/a\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003c/table\u003e\n            \u003c/td\u003e\n          \u003c/tr\u003e\n          \u003ctr\u003e\n            \u003ctd\u003e\n            \u003cdiv id\u003d\"stats\"\u003e\n            \u003cp id\u003d\"debug\" style\u003d\"display:inline;\"\u003e\u003c/p\u003e\n            \u003ctable id\u003d\"stattable\"\u003e\n            \u003ctr class\u003d\"positioncells\"\u003e\n              \u003ctd class\u003d\"positionlabels\" colspan\u003d\"2\" style\u003d\"text-align:center;\"\u003eNext stop\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr\u003e\n              \u003ctd id\u003d\"nextstage\" colspan\u003d\"2\" style\u003d\"text-align:center;\"\u003e\u003c?\u003d nextStage ?\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr\u003e\n              \u003ctd colspan\u003d\"2\"\u003e\u003chr\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr class\u003d\"positioncells\"\u003e\n              \u003ctd class\u003d\"positionlabels\"\u003eDistance to go :\u003c/td\u003e\n              \u003ctd id\u003d\"nextstagedistance\"\u003e\u003c?\u003d nextStageDistance ?\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr\u003e\n              \u003ctd colspan\u003d\"2\"\u003e\u003cp class\u003d\"space\"\u003e\u003c/p\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr class\u003d\"positioncells\"\u003e\n              \u003ctd class\u003d\"positionlabels\"\u003eArrival on :\u003c/td\u003e\n              \u003ctd id\u003d\"nextstagearrival\"\u003e\u003c?\u003d nextStageArrival ?\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n             \u003ctr\u003e\n              \u003ctd colspan\u003d\"2\"\u003e\u003chr\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr class\u003d\"positioncells\"\u003e\n              \u003ctd class\u003d\"positionlabels\"\u003eAverage speed :\u003c/td\u003e\n              \u003ctd id\u003d\"averagespeed\"\u003e\u003c?\u003d averagespeed ?\u003e Km/day\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr\u003e\n              \u003ctd colspan\u003d\"2\"\u003e\u003cp class\u003d\"space\"\u003e\u003c/p\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr class\u003d\"positioncells\"\u003e\n              \u003ctd class\u003d\"positionlabels\"\u003eFinal arrival on :\u003c/td\u003e\n              \u003ctd id\u003d\"estimatearrival\"\u003e\u003c?\u003d estimatedfinalarrival ?\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr\u003e\n              \u003ctd colspan\u003d\"2\"\u003e\u003chr\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr class\u003d\"positioncells\"\u003e\n                \u003ctd class\u003d\"positionlabels\"\u003eLatitude :\u003c/td\u003e\n                \u003ctd id\u003d\"latitude\"\u003e\u003c?\u003d latitude ?\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr\u003e\n              \u003ctd colspan\u003d\"2\"\u003e\u003cp class\u003d\"space\"\u003e\u003c/p\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr\u003e\n                \u003ctd class\u003d\"positionlabels\"\u003eLongitude :\u003c/td\u003e\n                \u003ctd id\u003d\"longitude\"\u003e\u003c?\u003d longitude ?\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr\u003e\n              \u003ctd colspan\u003d\"2\"\u003e\u003cp class\u003d\"space\"\u003e\u003c/p\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr class\u003d\"positioncells\"\u003e\n              \u003ctd class\u003d\"positionlabels\"\u003eAltitude :\u003c/td\u003e\n              \u003ctd id\u003d\"altitude\"\u003e\u003c?\u003d altitude ?\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n             \u003ctr\u003e\n              \u003ctd colspan\u003d\"2\"\u003e\u003cp class\u003d\"space\"\u003e\u003cbr\u003e\u003c/p\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr\u003e\n              \u003ctd colspan\u003d\"2\"\u003e\n              \u003cdiv id\u003d\"ad2\" style\u003d\"position:relative;left:-5px;\"\u003e\n              \u003cscript async src\u003d\"//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js\"\u003e\u003c/script\u003e\n              \u003c!-- Rectangular1 --\u003e\n              \u003cins class\u003d\"adsbygoogle\"\n              style\u003d\"display:inline-block;width:300px;height:250px\"\n              data-ad-client\u003d\"ca-pub-3801664724227747\"\n              data-ad-slot\u003d\"6796118242\"\u003e\u003c/ins\u003e\n              \u003cscript\u003e\n              (adsbygoogle \u003d window.adsbygoogle || []).push({});\n              \u003c/script\u003e\n              \u003c/div\u003e\n              \u003c/td\u003e\n            \u003c/tr\u003e        \n            \u003c/table\u003e\n            \u003c/div\u003e\n            \u003cdiv id\u003d\"waitstats\" style\u003d\u0027width:320px;height:645px;text-align:center;display:none;\u0027\u003e\u003cimg style\u003d\"margin-top:100px;\" src\u003d\u0027http://virtualtranscanada.com/resources/712 (2).gif\u0027\u003e\u003c/div\u003e\n            \u003c/td\u003e\n          \u003c/tr\u003e\n          \u003c/table\u003e\n          \u003c/div\u003e\n          \u003c/td\u003e\n        \u003c/tr\u003e     \n        \u003ctr\u003e\n          \u003ctd rowspan\u003d\"2\" colspan\u003d\"2\"\u003e\n          \u003cdiv class\u003d\"tile\"\u003e\n          \u003cdiv class\u003d\"headerbg\" style\u003d\"width:600px;\"\u003e\u003c/div\u003e\n          \u003cdiv class\u003d\"contentbg\" style\u003d\"width:600px;height:645px;\"\u003e\u003c/div\u003e\n          \u003ctable class\u003d\"largetiletable\"\u003e\n          \u003ctr\u003e\n            \u003ctd\u003e\n            \u003ctable class\u003d\"catheader\"\u003e\u003ctr\u003e\n              \u003ctd class\u003d\"p1\" style\u003d\"font:bold 16px verdana;\"\u003eHistory logs\u003c/td\u003e\n              \u003ctd class\u003d\"p1\" style\u003d\"text-align:right\"\u003e\u003ca class\u003d\"showhide\" onclick\u003d\"ShowHideFunction(\u0027history\u0027)\"\u003eShow/Hide\u003c/a\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003c/table\u003e\n            \u003c/td\u003e\n          \u003c/tr\u003e\n          \u003ctr\u003e\n            \u003ctd\u003e\n            \u003cdiv id\u003d\"history\"\u003e\n            \u003cdiv id\u003d\"todaydiv\" style\u003d\"display:block\"\u003e\n            \u003cp id\u003d\"todayheader\"\u003eToday\u003c/p\u003e\n            \u003ctable id\u003d\"todaylogtable\"\u003e\n            \u003ctr\u003e\n              \u003ctd class\u003d\"todaylogcells tablecyclingheader\"\u003e\u003cimg style\u003d\"position:relative;top:1px\" src\u003d\"http://virtualtranscanada.com/resources/velo24px.png\"\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"todaylogcells tablewalkingheader\"\u003e\u003cimg style\u003d\"position:relative;top:1px\" src\u003d\"http://virtualtranscanada.com/resources/walk24px.png\"\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"todaylogcells tableswimmingheader\"\u003e\u003cimg src\u003d\"http://virtualtranscanada.com/resources/swimming24px.png\"\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"todaylogcells tabletotalheader\"\u003eTotal\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr\u003e\n              \u003ctd class\u003d\"todaylogcells tablecyclingcontent\" id\u003d\"todaycycling\"\u003e\u003c?\u003d todayCyclingDistance ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"todaylogcells tablewalkingcontent\" id\u003d\"todaywalking\"\u003e\u003c?\u003d todayWalkingDistance ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"todaylogcells tableswimmingcontent\" id\u003d\"todayswimming\"\u003e0\u003c/td\u003e\n              \u003ctd class\u003d\"todaylogcells tabletotalcontent\" id\u003d\"todaytotal\"\u003e\u003c?\u003d todayTotalDistance ?\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003c/table\u003e\n            \u003c/div\u003e\n            \u003cdiv id\u003d\"waittoday\" style\u003d\u0027margin-left:auto;margin-right:auto;width:545px;height:50px;text-align:center;display:none;\u0027\u003e\u003cimg src\u003d\u0027http://virtualtranscanada.com/resources/712 (2).gif\u0027\u003e\u003c/div\u003e\n            \n            \u003cbr\u003e\u003chr\u003e\u003cbr\u003e\n            \u003cdiv id\u003d\"weekdiv\" style\u003d\"display:block\"\u003e\n            \u003cp id\u003d\"weekheader\"\u003e\u003c?\u003d weekDates ?\u003e\u003c/p\u003e\n            \u003ctable id\u003d\"lastnext\"\u003e\n            \u003ctr\u003e\n              \u003ctd class\u003d\"weekarrow\" style\u003d\"text-align:right;\"\u003e\u003cimg src\u003d\"http://virtualtranscanada.com/resources/leftarray.jpg\" style\u003d\"width:50%;height:auto;\" onclick\u003d\"LoadLastWeek()\"\u003e\u003c/td\u003e\n              \u003ctd\u003e\n              \u003ctable id\u003d\"weeklogtable\"\u003e\n              \u003ctr\u003e\n                \u003ctd class\u003d\"weeklogcells tablecyclingheader\"\u003e\u003cimg style\u003d\"position:relative;top:1px\" src\u003d\"http://virtualtranscanada.com/resources/velo24px.png\"\u003e\u003c/td\u003e\n                \u003ctd class\u003d\"weeklogcells tablewalkingheader\"\u003e\u003cimg style\u003d\"position:relative;top:1px\" src\u003d\"http://virtualtranscanada.com/resources/walk24px.png\"\u003e\u003c/td\u003e\n                \u003ctd class\u003d\"weeklogcells tableswimmingheader\"\u003e\u003cimg style\u003d\"position:relative;top:1px\" src\u003d\"http://virtualtranscanada.com/resources/swimming24px.png\"\u003e\u003c/td\u003e\n                \u003ctd class\u003d\"weeklogcells tabletotalheader\"\u003eTotal\u003c/td\u003e\n              \u003c/tr\u003e\n              \u003ctr\u003e\n                \u003ctd class\u003d\"weeklogcells tablecyclingcontent\" id\u003d\"weekcycling\"\u003e\u003c?\u003d weekCyclingDistance ?\u003e\u003c/td\u003e\n                \u003ctd class\u003d\"weeklogcells tablewalkingcontent\" id\u003d\"weekwalking\"\u003e\u003c?\u003d weekWalkingDistance ?\u003e\u003c/td\u003e\n                \u003ctd class\u003d\"weeklogcells tableswimmingcontent\" id\u003d\"weekswimming\"\u003e0\u003c/td\u003e\n                \u003ctd class\u003d\"weeklogcells tabletotalcontent\" id\u003d\"weektotal\"\u003e\u003c?\u003d weekTotalDistance ?\u003e\u003c/td\u003e\n              \u003c/tr\u003e\n              \u003c/table\u003e\n              \u003c/td\u003e\n              \u003ctd class\u003d\"weekarrow\"\u003e\u003cimg src\u003d\"http://virtualtranscanada.com/resources/rightarray.jpg\" style\u003d\"width:50%;height:auto;\" onclick\u003d\"LoadNextWeek()\"\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003c/table\u003e\n            \u003c/div\u003e\n            \u003cdiv id\u003d\"waitweek\" style\u003d\u0027margin-left:auto;margin-right:auto;width:545px;height:50px;text-align:center;display:none;\u0027\u003e\u003cimg src\u003d\u0027http://virtualtranscanada.com/resources/712 (2).gif\u0027\u003e\u003c/div\u003e\n            \u003cbr\u003e\u003chr\u003e\u003cbr\u003e\n            \u003cdiv id\u003d\"monthdiv\" style\u003d\"display:block;\"\u003e\n            \u003cp id\u003d\"monthheader\"\u003eYear 2015\u003c/p\u003e\n            \u003ctable id\u003d\"monthlogtable\"\u003e\n            \u003ctr\u003e\n              \u003ctd\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingheader\"\u003e\u003cimg style\u003d\"position:relative;top:1px\" src\u003d\"http://virtualtranscanada.com/resources/velo24px.png\"\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablewalkingheader\"\u003e\u003cimg style\u003d\"position:relative;top:1px\" src\u003d\"http://virtualtranscanada.com/resources/walk24px.png\"\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tableswimmingheader\"\u003e\u003cimg style\u003d\"position:relative;top:1px\" src\u003d\"http://virtualtranscanada.com/resources/swimming24px.png\"\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tabletotalheader\"\u003eTotal\u003c/td\u003e\n            \u003c/tr\u003e \n            \u003ctr class\u003d\"monthrow\"\u003e\n              \u003ctd class\u003d\"monthheader\"\u003eJan\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent jan\" id\u003d\"janc\"\u003e\u003c?\u003d janc ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent jan\" id\u003d\"janw\"\u003e\u003c?\u003d janw ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent jan\" id\u003d\"jans\"\u003e\u003c?\u003d jans ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent jan\" id\u003d\"jant\"\u003e\u003c?\u003d jant ?\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr class\u003d\"monthrow\"\u003e\n              \u003ctd class\u003d\"monthheader\"\u003eFeb\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent feb\" id\u003d\"febc\"\u003e\u003c?\u003d febc ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent feb\" id\u003d\"febw\"\u003e\u003c?\u003d febw ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent feb\" id\u003d\"febs\"\u003e\u003c?\u003d febs ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent feb\" id\u003d\"febt\"\u003e\u003c?\u003d febt ?\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr class\u003d\"monthrow\"\u003e\n              \u003ctd class\u003d\"monthheader\"\u003eMar\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent mar\" id\u003d\"marc\"\u003e\u003c?\u003d marc ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent mar\" id\u003d\"marw\"\u003e\u003c?\u003d marw ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent mar\" id\u003d\"mars\"\u003e\u003c?\u003d mars ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent mar\" id\u003d\"mart\"\u003e\u003c?\u003d mart ?\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr class\u003d\"monthrow\"\u003e\n              \u003ctd class\u003d\"monthheader\"\u003eApr\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent apr\" id\u003d\"aprc\"\u003e\u003c?\u003d aprc ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent apr\" id\u003d\"aprw\"\u003e\u003c?\u003d aprw ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent apr\" id\u003d\"aprs\"\u003e\u003c?\u003d aprs ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent apr\" id\u003d\"aprt\"\u003e\u003c?\u003d aprt ?\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr class\u003d\"monthrow\"\u003e\n              \u003ctd class\u003d\"monthheader\"\u003eMay\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent may\" id\u003d\"mayc\"\u003e\u003c?\u003d mayc ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent may\" id\u003d\"mayw\"\u003e\u003c?\u003d mayw ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent may\" id\u003d\"mays\"\u003e\u003c?\u003d mays ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent may\" id\u003d\"mayt\"\u003e\u003c?\u003d mayt ?\u003e\u003c/td\u003e\n            \u003c/tr\u003e \n            \u003ctr class\u003d\"monthrow\"\u003e\n              \u003ctd class\u003d\"monthheader\"\u003eJun\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent jun\" id\u003d\"junc\"\u003e\u003c?\u003d junc ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent jun\" id\u003d\"junw\"\u003e\u003c?\u003d junw ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent jun\" id\u003d\"juns\"\u003e\u003c?\u003d juns ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent jun\" id\u003d\"junt\"\u003e\u003c?\u003d junt ?\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr class\u003d\"monthrow\"\u003e\n              \u003ctd class\u003d\"monthheader\"\u003eJul\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent jul\" id\u003d\"julc\"\u003e\u003c?\u003d julc ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent jul\" id\u003d\"julw\"\u003e\u003c?\u003d julw ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent jul\" id\u003d\"juls\"\u003e\u003c?\u003d juls ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent jul\" id\u003d\"jult\"\u003e\u003c?\u003d jult ?\u003e\u003c/td\u003e\n            \u003c/tr\u003e \n            \u003ctr class\u003d\"monthrow\"\u003e\n              \u003ctd class\u003d\"monthheader\"\u003eAug\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent aug\" id\u003d\"augc\"\u003e\u003c?\u003d augc ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent aug\" id\u003d\"augw\"\u003e\u003c?\u003d augw ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent aug\" id\u003d\"augs\"\u003e\u003c?\u003d augs ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent aug\" id\u003d\"augt\"\u003e\u003c?\u003d augt ?\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr class\u003d\"monthrow\"\u003e\n              \u003ctd class\u003d\"monthheader\"\u003eSep\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent sep\" id\u003d\"sepc\"\u003e\u003c?\u003d sepc ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent sep\" id\u003d\"sepw\"\u003e\u003c?\u003d sepw ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent sep\" id\u003d\"seps\"\u003e\u003c?\u003d seps ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent sep\" id\u003d\"sept\"\u003e\u003c?\u003d sept ?\u003e\u003c/td\u003e\n            \u003c/tr\u003e \n            \u003ctr class\u003d\"monthrow\"\u003e\n              \u003ctd class\u003d\"monthheader\"\u003eOct\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent oct\" id\u003d\"octc\"\u003e\u003c?\u003d octc ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent oct\" id\u003d\"octw\"\u003e\u003c?\u003d octw ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent oct\" id\u003d\"octs\"\u003e\u003c?\u003d octs ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent oct\" id\u003d\"octt\"\u003e\u003c?\u003d octt ?\u003e\u003c/td\u003e\n            \u003c/tr\u003e \n            \u003ctr class\u003d\"monthrow\"\u003e\n              \u003ctd class\u003d\"monthheader\"\u003eNov\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent nov\" id\u003d\"novc\"\u003e\u003c?\u003d novc ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent nov\" id\u003d\"novw\"\u003e\u003c?\u003d novw ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent nov\" id\u003d\"novs\"\u003e\u003c?\u003d novs ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent nov\" id\u003d\"novt\"\u003e\u003c?\u003d novt ?\u003e\u003c/td\u003e\n            \u003c/tr\u003e        \n            \u003ctr class\u003d\"monthrow\"\u003e\n              \u003ctd class\u003d\"monthheader\"\u003eDec\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent dec\" id\u003d\"decc\"\u003e\u003c?\u003d decc ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent dec\" id\u003d\"decw\"\u003e\u003c?\u003d decw ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent dec\" id\u003d\"decs\"\u003e\u003c?\u003d decs ?\u003e\u003c/td\u003e\n              \u003ctd class\u003d\"monthlogcells tablecyclingcontent dec\" id\u003d\"dect\"\u003e\u003c?\u003d dect ?\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003c/table\u003e\n            \u003cbr\u003e\n            \u003c/div\u003e\n            \u003cdiv id\u003d\"waitmonth\" style\u003d\u0027margin-left:auto;margin-right:auto;width:545px;height:50px;text-align:center;display:none;\u0027\u003e\u003cimg src\u003d\u0027http://virtualtranscanada.com/resources/712 (2).gif\u0027\u003e\u003c/div\u003e\n            \u003c/div\u003e\n            \u003c/td\u003e\n          \u003c/tr\u003e\n          \u003c/table\u003e\n          \u003c/div\u003e\n          \u003c/td\u003e\n        \u003c/tr\u003e\n        \u003ctr\u003e\n          \u003ctd\u003e\n          \u003cdiv class\u003d\"tile\" id\u003d\"logdatatile\"\u003e\n          \u003cdiv class\u003d\"headerbg\" style\u003d\"width:320px;\"\u003e\u003c/div\u003e\n          \u003cdiv class\u003d\"contentbg\" style\u003d\"width:320px;height:195px;\"\u003e\u003c/div\u003e\n          \u003ctable class\u003d\"smalltiletable\"\u003e\n          \u003ctr\u003e\n            \u003ctd\u003e\n            \u003ctable class\u003d\"catheader\"\u003e\n            \u003ctr\u003e\n              \u003ctd class\u003d\"p1\" style\u003d\"font:bold 16px verdana;\"\u003eLog data\u003c/td\u003e\n              \u003ctd class\u003d\"p1\" style\u003d\"text-align:right\"\u003e\u003ca class\u003d\"showhide\" onclick\u003d\"ShowHideFunction(\u0027stats\u0027)\"\u003eShow/Hide\u003c/a\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003c/table\u003e\n            \u003c/td\u003e\n          \u003c/tr\u003e\n          \u003ctr\u003e\n            \u003ctd\u003e\n            \u003cdiv id\u003d\"logdata\"\u003e\n            \u003ctable id\u003d\"logdatatable\"\u003e\n            \u003ctr\u003e\n              \u003ctd class\u003d\"addlogcells\"\u003e\n              \u003ctable id\u003d\"loginputtable\"\u003e\n              \u003ctr\u003e\n                \u003ctd class\u003d\"labeladdlogcells\"\u003eCycling\u003c/td\u003e\n                \u003ctd class\u003d\"addlogcells\"\u003e\u003cinput type\u003d\"text\" value\u003d0 class\u003d\"loginput\" id\u003d\"cyclinginput\" onclick\u003d\"this.select()\" onkeypress\u003d\"enterData(event)\"\u003e\u003c/td\u003e\n              \u003c/tr\u003e\n              \u003ctr\u003e\n                \u003ctd class\u003d\"labeladdlogcells\"\u003eWalking\u003c/td\u003e\n                \u003ctd class\u003d\"addlogcells\"\u003e\u003cinput type\u003d\"text\" value\u003d0 class\u003d\"loginput\" id\u003d\"walkinginput\" onclick\u003d\"this.select()\" onkeypress\u003d\"enterData(event)\"\u003e\u003c/td\u003e\n              \u003c/tr\u003e\n              \u003ctr\u003e\n                \u003ctd class\u003d\"labeladdlogcells\"\u003eSwimming\u003c/td\u003e\n                \u003ctd class\u003d\"addlogcells\"\u003e\u003cinput type\u003d\"text\" value\u003d0 class\u003d\"loginput\" id\u003d\"swimminginput\" onclick\u003d\"this.select()\" onkeypress\u003d\"enterData(event)\"\u003e\u003c/td\u003e\n              \u003c/tr\u003e\n              \u003c/table\u003e\n              \u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr\u003e\u003ctd\u003e\u003cbr\u003e\u003c/td\u003e\u003c/tr\u003e\n            \u003ctr\u003e\n              \u003ctd id\u003d\"msglog\"\u003e\u0026nbsp;\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr\u003e\n              \u003ctd\u003e\u003cp style\u003d\"margin-top:0px;margin-bottom:0px\"\u003e\u003c/p\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003ctr\u003e\n              \u003ctd class\u003d\"addlogcells\"\u003e\n              \u003cbutton id\u003d\"buttonlogok\" type\u003d\"button\" onclick\u003d\"logData()\"\u003eOk\u003c/button\u003e\n              \u003c/td\u003e\n            \u003c/tr\u003e\n            \u003c/table\u003e\n            \u003cbr\u003e\u003cbr\u003e\n            \u003cdiv  id\u003d\"ad3\" style\u003d\"position:relative;left:-5px;top:-5px\"\u003e\n            \u003cscript async src\u003d\"//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js\"\u003e\u003c/script\u003e\n            \u003c!-- Minibanner1 --\u003e\n            \u003cins class\u003d\"adsbygoogle\"\n            style\u003d\"display:inline-block;width:320px;height:100px\"\n            data-ad-client\u003d\"ca-pub-3801664724227747\"\n            data-ad-slot\u003d\"2226317841\"\u003e\u003c/ins\u003e\n            \u003cscript\u003e\n            (adsbygoogle \u003d window.adsbygoogle || []).push({});\n            \u003c/script\u003e\n            \u003c/div\u003e\n            \u003c/div\u003e\n            \u003c/td\u003e\n          \u003c/tr\u003e\n          \u003c/table\u003e\n          \u003c/div\u003e\n          \u003c/td\u003e\n        \u003c/tr\u003e\n        \u003ctr\u003e\n          \u003ctd colspan\u003d\"2\"\u003e\n          \u003cdiv class\u003d\"tile\"\u003e\n          \u003ctable class\u003d\"midlargetiletable\"\u003e\n          \u003ctr\u003e\n            \u003ctd\u003e\n            \u003cdiv style\u003d\"width:600px;height:332px;\"\u003e\n            \u003cdiv class\u003d\"bss-slides demo1\" id\u003d\"imagegallery\" tabindex\u003d\"1\" autofocus\u003d\"autofocus\"\u003e\n            \u003cfigure\u003e\n\t\t      \u003cimg src\u003d\"http://virtualtranscanada.com/resources/stjohnimg1.jpg\" width\u003d\"100%\" /\u003e\u003cfigcaption\u003eSt John\u0027s, Newfoundland\u003c/figcaption\u003e \n            \u003c/figure\u003e\n            \u003cfigure\u003e\n\t\t      \u003cimg src\u003d\"http://virtualtranscanada.com/resources/stjohnimg2.jpg\" width\u003d\"100%\" /\u003e\u003cfigcaption\u003eSt John\u0027s, Newfoundland\u003c/figcaption\u003e \n            \u003c/figure\u003e\n            \u003cfigure\u003e\n\t\t      \u003cimg src\u003d\"http://virtualtranscanada.com/resources/stjohnimg3.jpg\" width\u003d\"100%\" /\u003e\u003cfigcaption\u003eSt John\u0027s, Newfoundland\u003c/figcaption\u003e \n            \u003c/figure\u003e\n            \u003cfigure\u003e\n\t\t      \u003cimg src\u003d\"http://virtualtranscanada.com/resources/stjohnimg4.jpg\" width\u003d\"100%\" /\u003e\u003cfigcaption\u003eSt John\u0027s, Newfoundland\u003c/figcaption\u003e \n            \u003c/figure\u003e\n            \u003c/div\u003e \u003c!-- // bss-slides --\u003e\n            \u003c/div\u003e\n            \u003cscript src\u003d\"http://virtualtranscanada.com/resources/hammer.min.js\"\u003e\u003c/script\u003e\u003c!-- for swipe support on touch interfaces --\u003e\n            \u003c/td\u003e\n          \u003c/tr\u003e\n          \u003c/table\u003e\n          \u003c/div\u003e\n          \u003c/td\u003e\n          \u003ctd\u003e\n          \u003cdiv class\u003d\"tile\" id\u003d\"galleryselectiontile\"\u003e\n          \u003cdiv class\u003d\"headerbg\" style\u003d\"width:320px;\"\u003e\u003c/div\u003e\n          \u003cdiv class\u003d\"contentbg\" style\u003d\"width:320px;height:300px;\"\u003e\u003c/div\u003e\n          \u003ctable class\u003d\"smalltiletable\"\u003e\n          \u003ctr\u003e\n            \u003ctd\u003e\n            \u003ctable class\u003d\"catheader\"\u003e\n            \u003ctr\u003e\n              \u003ctd class\u003d\"p1\" style\u003d\"font:bold 16px verdana;\"\u003eGallery\u003c/td\u003e\n              \u003ctd class\u003d\"p1\" style\u003d\"text-align:right\"\u003e\u003ca class\u003d\"showhide\" onclick\u003d\"ShowHideFunction(\u0027stats\u0027)\"\u003eShow/Hide\u003c/a\u003e\u003c/td\u003e\n            \u003c/tr\u003e\n            \u003c/table\u003e\n            \u003c/td\u003e\n          \u003c/tr\u003e\n          \u003ctr\u003e\n            \u003ctd\u003e\n            \u003cdiv id\u003d\"gallery\"\u003e\n            \u003ctable id\u003d\"gallerytable\"\u003e\n            \u003ctr\u003e\n              \u003ctd\u003e\n              \u003cselect id\u003d\"selection\" size\u003d\"16\" style\u003d\"width:300px\" onchange\u003d\"setImageGallery()\"\u003e\n                \u003coption value\u003d\"1\"\u003eSt John\u0027s, Newfoundland\u003c/option\u003e\n                \u003coption value\u003d\"2\"\u003eGrand Falls Windsor, Newfoundland\u003c/option\u003e\n                \u003coption value\u003d\"3\"\u003eCorner Brook, Newfoundland\u003c/option\u003e\n                \u003coption value\u003d\"4\"\u003eSidney, Nova Scotia\u003c/option\u003e\n                \u003coption value\u003d\"5\"\u003eMoncton, New Brunswick\u003c/option\u003e\n                \u003coption value\u003d\"6\"\u003eFredericton, Nova Scotia\u003c/option\u003e\n                \u003coption value\u003d\"7\"\u003eQuébec, Québec\u003c/option\u003e\n                \u003coption value\u003d\"8\"\u003eMontréal, Québec\u003c/option\u003e\n                \u003coption value\u003d\"9\"\u003eOttawa, Ontario\u003c/option\u003e\n                \u003coption value\u003d\"10\"\u003ePeterborough, Ontario\u003c/option\u003e\n                \u003coption value\u003d\"11\"\u003eSudbury, Ontario\u003c/option\u003e\n                \u003coption value\u003d\"12\"\u003eSault Ste. Marie, Ontario\u003c/option\u003e\n                \u003coption value\u003d\"13\"\u003eThunder bay, Ontario\u003c/option\u003e\n                \u003coption value\u003d\"14\"\u003eKenora, Ontario\u003c/option\u003e\n                \u003coption value\u003d\"15\"\u003eWinnipeg, Manitoba\u003c/option\u003e\n                \u003coption value\u003d\"16\"\u003eRegina, Saskatchewan\u003c/option\u003e\n                \u003coption value\u003d\"17\"\u003eCalgary, Alberta\u003c/option\u003e\n                \u003coption value\u003d\"18\"\u003eKamploops, British Columbia\u003c/option\u003e\n                \u003coption value\u003d\"19\"\u003eAbbotsford, British Columbia\u003c/option\u003e\n                \u003coption value\u003d\"20\"\u003eVancouver, British Columbia\u003c/option\u003e\n                \u003coption value\u003d\"21\"\u003eNanaimo, British Columbia\u003c/option\u003e\n                \u003coption value\u003d\"22\"\u003eVictoria, British Columbia\u003c/option\u003e\n              \u003c/select\u003e\n              \u003c/td\u003e\n            \u003c/tr\u003e\n            \u003c/table\u003e\n            \u003c/div\u003e\n            \u003c/td\u003e\n          \u003c/tr\u003e\n          \u003c/table\u003e\n          \u003c/div\u003e\n          \u003c/td\u003e\n        \u003c/tr\u003e\n        \u003c/table\u003e\n        \u003cdiv style\u003d\"height:30px\"\u003e\u003c/div\u003e\n        \u003cdiv id\u003d\"footer\"\u003e\n        \u003cp style\u003d\"margin-top:5px;margin-bottom:5px;\"\u003e\n        \u003ca\u003eAbout\u003c/a\u003e\u0026nbsp;\u0026nbsp;\n        \u003ca\u003eContact us\u003c/a\u003e\u0026nbsp;\u0026nbsp;\n        \u003ca\u003eHelp\u003c/a\u003e\u0026nbsp;\u0026nbsp;\n        \u003ca\u003eTerm of service\u003c/a\u003e\u0026nbsp;\u0026nbsp;\n        \u003ca\u003ePrivate policy\u003c/a\u003e\u0026nbsp;\u0026nbsp;\n        \u0026#169; 2015 Alban Chauvin\n        \u003c/p\u003e\n        \u003c/div\u003e\n        \u003cscript\u003e\n        //Set achievement div location\n        document.getElementById(\"achievement\").style.left \u003d (parseInt((window.innerWidth/2))-parseInt( document.getElementById(\"achievement\").offsetWidth/2))+\"px\";\n        document.getElementById(\"achievement\").style.top \u003d (parseInt((window.innerHeight/2))-parseInt( document.getElementById(\"achievement\").offsetHeight/2))+\"px\";\n\n        document.getElementById(\"map-canvas\").addEventListener(\"webkitTransitionEnd\", TriggerMapResize);\n        document.getElementById(\"map-canvas\").addEventListener(\"transitionend\", TriggerMapResize);\n    \n        document.getElementById(\"map-canvas\").addEventListener(\"onmouseover\", TriggerMapResize);\n        \n        var makeBSS \u003d function (el, options) {\n        var $slideshows \u003d document.querySelectorAll(el), // a collection of all of the slideshow\n        $slideshow \u003d {},\n        Slideshow \u003d {\n            init: function (el, options) {\n                this.counter \u003d 0; // to keep track of current slide\n                this.el \u003d el; // current slideshow container    \n                this.$items \u003d el.querySelectorAll(\u0027figure\u0027); // a collection of all of the slides, caching for performance\n                this.numItems \u003d this.$items.length; // total number of slides\n                options \u003d options || {}; // if options object not passed in, then set to empty object \n                options.auto \u003d options.auto || false; // if options.auto object not passed in, then set to false\n                this.opts \u003d {\n                    auto: (typeof options.auto \u003d\u003d\u003d \"undefined\") ? false : options.auto,\n                    speed: (typeof options.auto.speed \u003d\u003d\u003d \"undefined\") ? 1500 : options.auto.speed,\n                    pauseOnHover: (typeof options.auto.pauseOnHover \u003d\u003d\u003d \"undefined\") ? false : options.auto.pauseOnHover,\n                    fullScreen: (typeof options.fullScreen \u003d\u003d\u003d \"undefined\") ? false : options.fullScreen,\n                    swipe: (typeof options.swipe \u003d\u003d\u003d \"undefined\") ? false : options.swipe\n                };\n                \n                this.$items[0].classList.add(\u0027bss-show\u0027); // add show class to first figure \n                this.injectControls(el);\n                this.addEventListeners(el);\n                if (this.opts.auto) {\n                    this.autoCycle(this.el, this.opts.speed, this.opts.pauseOnHover);\n                }\n                if (this.opts.fullScreen) {\n                    this.addFullScreen(this.el);\n                }\n                if (this.opts.swipe) {\n                    this.addSwipe(this.el);\n                }\n            },\n            showCurrent: function (i) {\n                // increment or decrement this.counter depending on whether i \u003d\u003d\u003d 1 or i \u003d\u003d\u003d -1\n                if (i \u003e 0) {\n                    this.counter \u003d (this.counter + 1 \u003d\u003d\u003d this.numItems) ? 0 : this.counter + 1;\n                } else {\n                    this.counter \u003d (this.counter - 1 \u003c 0) ? this.numItems - 1 : this.counter - 1;\n                }\n\n                // remove .show from whichever element currently has it \n                // http://stackoverflow.com/a/16053538/2006057\n                [].forEach.call(this.$items, function (el) {\n                    el.classList.remove(\u0027bss-show\u0027);\n                });\n  \n                // add .show to the one item that\u0027s supposed to have it\n                this.$items[this.counter].classList.add(\u0027bss-show\u0027);\n            },\n            injectControls: function (el) {\n            // build and inject prev/next controls\n                // first create all the new elements\n                var spanPrev \u003d document.createElement(\"span\"),\n                    spanNext \u003d document.createElement(\"span\"),\n                    docFrag \u003d document.createDocumentFragment();\n        \n                // add classes\n                spanPrev.classList.add(\u0027bss-prev\u0027);\n                spanNext.classList.add(\u0027bss-next\u0027);\n        \n                // add contents\n                spanPrev.innerHTML \u003d \u0027\u0026laquo;\u0027;\n                spanNext.innerHTML \u003d \u0027\u0026raquo;\u0027;\n                \n                // append elements to fragment, then append fragment to DOM\n                docFrag.appendChild(spanPrev);\n                docFrag.appendChild(spanNext);\n                el.appendChild(docFrag);\n            },\n            addEventListeners: function (el) {\n                var that \u003d this;\n                el.querySelector(\u0027.bss-next\u0027).addEventListener(\u0027click\u0027, function () {\n                    that.showCurrent(1); // increment \u0026 show\n                }, false);\n            \n                el.querySelector(\u0027.bss-prev\u0027).addEventListener(\u0027click\u0027, function () {\n                    that.showCurrent(-1); // decrement \u0026 show\n                }, false);\n                \n                el.onkeydown \u003d function (e) {\n                    e \u003d e || window.event;\n                    if (e.keyCode \u003d\u003d\u003d 37) {\n                        that.showCurrent(-1); // decrement \u0026 show\n                    } else if (e.keyCode \u003d\u003d\u003d 39) {\n                        that.showCurrent(1); // increment \u0026 show\n                    }\n                };\n            },\n            autoCycle: function (el, speed, pauseOnHover) {\n                var that \u003d this,\n                    interval \u003d window.setInterval(function () {\n                        that.showCurrent(1); // increment \u0026 show\n                    }, speed);\n                \n                if (pauseOnHover) {\n                    el.addEventListener(\u0027mouseover\u0027, function () {\n                        interval \u003d clearInterval(interval);\n                    }, false);\n                    el.addEventListener(\u0027mouseout\u0027, function () {\n                        interval \u003d window.setInterval(function () {\n                            that.showCurrent(1); // increment \u0026 show\n                        }, speed);\n                    }, false);\n                } // end pauseonhover\n                \n            },\n            addFullScreen: function(el){\n                var that \u003d this,\n                fsControl \u003d document.createElement(\"span\");\n                \n                fsControl.classList.add(\u0027bss-fullscreen\u0027);\n                el.appendChild(fsControl);\n                el.querySelector(\u0027.bss-fullscreen\u0027).addEventListener(\u0027click\u0027, function () {\n                    that.toggleFullScreen(el);\n                }, false);\n            },\n            addSwipe: function(el){\n                var that \u003d this,\n                    ht \u003d new Hammer(el);\n                ht.on(\u0027swiperight\u0027, function(e) {\n                    that.showCurrent(-1); // decrement \u0026 show\n                });\n                ht.on(\u0027swipeleft\u0027, function(e) {\n                    that.showCurrent(1); // increment \u0026 show\n                });\n            },\n            toggleFullScreen: function(el){\n                if (!document.fullscreenElement \u0026\u0026    // alternative standard method\n                    !document.mozFullScreenElement \u0026\u0026 !document.webkitFullscreenElement \u0026\u0026   \n                    !document.msFullscreenElement ) {  // current working methods\n                    if (document.documentElement.requestFullscreen) {\n                      el.requestFullscreen();\n                    } else if (document.documentElement.msRequestFullscreen) {\n                      el.msRequestFullscreen();\n                    } else if (document.documentElement.mozRequestFullScreen) {\n                      el.mozRequestFullScreen();\n                    } else if (document.documentElement.webkitRequestFullscreen) {\n                      el.webkitRequestFullscreen(el.ALLOW_KEYBOARD_INPUT);\n                    }\n                } else {\n                    if (document.exitFullscreen) {\n                      document.exitFullscreen();\n                    } else if (document.msExitFullscreen) {\n                      document.msExitFullscreen();\n                    } else if (document.mozCancelFullScreen) {\n                      document.mozCancelFullScreen();\n                    } else if (document.webkitExitFullscreen) {\n                      document.webkitExitFullscreen();\n                    }\n                }\n            } // end toggleFullScreen\n            \n        }; // end Slideshow object \n        \n    // make instances of Slideshow as needed\n    [].forEach.call($slideshows, function (el) {\n        $slideshow \u003d Object.create(Slideshow);\n        $slideshow.init(el, options);\n    });\n    };\n    var opts \u003d {\n    auto : {\n        speed : 5000, \n        pauseOnHover : true\n    },\n    fullScreen : true, \n    swipe : true\n    };\n    //makeBSS(\u0027.demo1\u0027, opts);\n\n    //Enables unlocked gallery and \n    EnableDisableGalleryOptions();\n    setImageGallery();\n \n    \n    \n    //Ads ?\n    var ads \u003d \u003c?\u003d displayads ?\u003e + \"\";\n    \n    if(ads\u003d\u003d\"false\")\n    {\n      document.getElementById(\"ad1\").style.display\u003d\"none\";\n      document.getElementById(\"ad2\").style.display\u003d\"none\";\n      document.getElementById(\"ad3\").style.display\u003d\"none\";\n    }\n    \u003c/script\u003e\n\u003c/body\u003e\n\u003c/html\u003e"},{"id":"fdef2439-9e8e-4b76-ae8c-6be2469631e8","name":"stylesheet","type":"html","source":"\u003cstyle\u003e\n\nhtml{\n    position:relative;\n}\n\nbody {\n    background-color:#E6E6E6;\n    background-attachment: fixed;\n    background-attachment: cover;\n    background-repeat:no-repeat;\n    font: 14px verdana, sans-serif;\n}\n\nh1 {\n    color: black;\n    text-align:center;\n}\n\n#title{\n    position:absolute;\n    top:0px;\n    left:0px;\n    width:100%;\n    height:40px;\n    background-color:#CEF6CE;\n    z-index: 7;\n}\n\n#menu{\n    position:absolute;\n    top:40px;\n    left:0px;\n    width:100%;\n    height:5px;\n    background-color:green;\n    -webkit-box-shadow: 0px 5px 10px 0px rgba(50, 50, 50, 0.3);\n    -moz-box-shadow:    0px 5px 10px 0px rgba(50, 50, 50, 0.3);\n    box-shadow:         0px 5px 10px 0px rgba(50, 50, 50, 0.3);\n    z-index: 7;\n}\n\n#menu p{\n    padding-left:15px;\n    margin-top:3px;\n    margin-bottom:2px;\n}\n\n#menu table{\n    color:white;\n}\n\n#footer{\n    background-color:green;\n    color:white;\n    width:100%;\n    height:30px;\n    position:absolute;\n    bottom:0px;\n    left:0px;\n    text-align:center;\n}\n\n#footer a:hover{\n    text-decoration:underline;\n    cursor:pointer;\n}\n\n\n.ads{\n    background-color:white;\n    opacity:0.6;\n    border-radius:5px;\n}\n\n.dynamicmap {\n        width: 600px;\n        height: 330px;\n        left:0px;\n        top:5px;\n        border-radius:5px;\n        border:1px solid black;\n        position:absolute;\n        z-index: 4;\n        -webkit-transition: width 0.3s ease-in, height 0.3s ease-in;\n\t    -moz-transition: width 0.3s ease-in, height 0.3s ease-in;\n\t    -o-transition: width 0.3s ease-in, height 0.3s ease-in;\n\t    transition: width 0.3s ease-in, height 0.3s ease-in;\n      }\n      \n.dynamicmapchange{\n        width: 930px;\n        height: 450px;\n        box-shadow: 0px 0px 20px black;\n}\n\n.catheader{\n    color:white;\n    z-index: 1;\n    position:relative;\n}\n\n.largetiletable, .midtalltiletable{\n    height:676px;\n}\n\n.smalltiletable, .midlargetiletable{\n    height:332px;\n}\n\n.largetiletable, .midlargetiletable{\n    width:600px;\n}\n\n.smalltiletable, .midtalltiletable{\n    width:300px;\n}\n\n.tile{\n    position:relative;\n}\n\n.smalltiletable, .largetiletable, .midtalltiletable{\n    border-spacing:2px;\n}\n\n#maintbl{\n    margin-left:auto;\n    margin-right:auto;\n    text-align:center;\n    width:900px;\n    border-style:none;\n    position:relative;\n}\n\n#topband {\n    margin-left:auto;\n    margin-right:auto;\n    border-style:none;\n}\n\ntr, td{\n    border-style:none;\n}\n\n.carheader{\n    margin-left:auto;\n    margin-right:auto;\n}\n\n.blank{\n    width:600px;\n}\n\n.showhide{\n    font:10px \"Times New Roman\";\n    color:blue;\n    visibility:hidden;\n}\n\n.showhide:hover{\n    color:red;\n    cursor:pointer;\n}\n\n#logdatatable{\n    margin-left:auto;\n    margin-right:auto;\n    margin-bottom:5px;\n    position:relative;\n    top:15px;\n}\n\n#addlogtable{\n    padding-right: 15px;\n    padding-left: 15px;\n    padding-top: 15px;\n    padding-bottom: 15px;\n    margin-left:auto;\n    margin-right:auto;\n    border:1px solid green;\n    background-color:white;\n    border-radius:10px;\n}\n\n.loginput{\n    background-color:white;\n    border:1px solid green;\n}\n\n#lastnext, #addlogbuttontable, #todaylogtable, #weeklogtable, #monthlogtable, #minimaps, #stattable{\n    margin-left:auto;\n    margin-right:auto;\n}\n\n#maps, #currentposition{\n    text-align:center;\n}\n\n#currentposition{\n    border-spacing:9px;\n}\n\n#stattable\n{\n    text-align:left;\n    position:relative;\n    top:10px;\n    border-spacing:5px;\n    font:14px verdana, sans-serif;\n    \n}\n\nhr{\n   width:50px;\n   margin-left:auto;\n   margin-right:auto;\n   border-color:green;\n}\n\n.positionlabels{\n    text-align:right;\n    font-weight:bold;\n    color:green;\n}\n\n#location, #history, #stats, #maps, #logdata, #gallery{\n    border-radius:5px;\n    position:relative;\n    z-index: 1;\n}\n\n#location, #logdata, #gallery, #maps{\n    height:300px;\n}\n\n#history {\n    height:640px;\n    position:relative;\n    top:15px;\n}\n\n#stats{\n    height:640px;\n}\n\n.space{\n   margin-bottom: 0px;\n   margin-top: 0px;\n}\n\n.headerbg{\n    background-color:green;\n    color:white;\n    border-radius:5px;\n    border:1px solid black;\n    opacity:0.8;\n    position:absolute;\n    top:2px;\n    height:26px;\n    z-index: 0;\n}\n\n.contentbg{\n    border-radius:5px;\n    background-color:#CEF6CE;\n    border:1px solid black;\n    opacity:0.9;\n    position:absolute;\n    top:32px;\n}\n\n#todayheader,#weekheader,#monthheader{\n  text-align:center;\n  font-weight:bold;\n  margin-top: 5px; \n  margin-bottom: 5px;\n}        \n\n.weekarrow{\n  padding-right: 1px;\n  padding-left: 1px;\n  padding-top: 5px;\n}\n\n.todaylogcells, .weeklogcells, .monthlogcells{\n    text-align:center;\n    padding-right: 15px;\n    padding-left: 15px;\n    border-radius:5px;\n    width:70px;\n}\n\n.tablecyclingheader{\n    background-color:green;\n    color:white;\n}\n\n.tablewalkingheader{\n    background-color:green;\n    color:white;\n}\n\n.tableswimmingheader{\n    background-color:green;\n    color:white;\n}\n\n.tabletotalheader{\n    background-color:green;\n    color:white;\n    font-weight:bold;\n}\n\n.tablecyclingcontent{\n    background-color:white;\n    color:black;\n    border:1px solid green;\n}\n\n.tablewalkingcontent{\n    background-color:white;\n    color:black;\n    border:1px solid green;\n}\n\n.tableswimmingcontent{\n    background-color:white;\n    color:black;\n    border:1px solid green;\n}\n\n.tabletotalcontent{\n    background-color:white;\n    color:black;\n    border:1px solid green;\n    font-weight:bold;\n}\n\n.addlogcells{\n    text-align:center;\n}\n\n.labeladdlogcells{\n    text-align:right;\n    padding-right: 5px;\n    padding-left: 5px;\n    font-weight:bold;\n}\n\n.loginput{\n    width:100px;\n    background-color:white;\n    border-radius:3px;\n    font-size:14px;\n    padding-left: 5px;\n}\n\n#buttonlogok{\n    width:85px;\n    height:35px;\n    border-radius:3px;\n    background-color:white;\n    border:1px solid green;\n    color:black;\n}\n\n#buttonlogok:hover{\n    background-color:#CEF6CE;\n}\n\n#loginputtable{\n    border-spacing:2px\n}\n\n.monthheader{\n    text-align:center;\n    padding-right: 5px;\n    padding-left: 5px;\n    width:25px;\n    background-color:#D3D3D3;\n    color:black;\n    border:1px solid black;\n    border-radius:5px;\n}\n\n#monthlogtable{\n    position:relative;\n}\n\n#todaydiv, #weekdiv, #monthdiv, #history{\n    margin-left: auto;\n    margin-right: auto;\n}\n\n#addloglink{\n    text-align:center;\n}\n\n#addloglink:hover{\n    text-align:center;\n    color:red;\n    cursor:pointer;\n}\n\n#table,#td{\n    border:1px solid red;\n}\n\n#selection{\n    background-color:#CEF6CE;\n    color:green;\n    border:1px solid green;\n    border-radius:3px;\n    position:relative;\n    left:5px;\n    top:10px;\n}\n\n.monthrow:hover .monthlogcells{\n   background-color:#CEF6CE;\n}\n\n#blackfilter{\n   background-color:white;\n   position:fixed;\n   top:0;\n   left:0;\n   width:100%;\n   height:100%;\n   opacity:0.8;\n   z-index:5;\n   visibility: hidden;\n}\n\n#achievement{\n   background-color:#CEF6CE;\n   position:fixed;\n   margin-left:auto;\n   margin-right:auto;\n   width:500px;\n   height:300px;\n   opacity:1;\n   border:1px solid green;\n   border-radius:5px;\n   z-index:6;\n   visibility: hidden;\n}\n\n\n\n.bss-slides{\n  background: #000;\n  position: relative;\n  left:-3px;\n  height:332px;\n  width:600px;\n  border-radius:5px;\n  display: block;   \n}\n.bss-slides:focus{\n outline: 0;\n}\n.bss-slides figure{\n  position: absolute;\n  width: 100%;\n  \n}\n.bss-slides figure img{\n  opacity: 0;\n  -webkit-transition: opacity 1.2s;\n  transition: opacity 1.2s;\n  position: relative;\n  left:-40px;\n  top:-14px;\n  border-radius:5px;\n  border:1px solid black\n/*-webkit-backface-visibility: hidden;\n  backface-visibility: hidden;\n  */\n}\n.bss-slides .bss-show {\n  z-index: 3;\n}\n.bss-slides .bss-show img{\n  opacity: 1;\n /* -webkit-backface-visibility: hidden;\n  backface-visibility: hidden;*/\n}\n\n.bss-slides figcaption{\n  position: absolute;\n  font-family: sans-serif;\n  font-size: .8em;\n  bottom: 2em;\n  right: 4em;\n  padding: .25em;\n  color: #fff;\n  background: #000;\n  background: rgba(0,0,0, .25);\n  border-radius: 2px;\n  opacity: 0;\n  -webkit-transition: opacity 1.2s;\n  transition: opacity 1.2s;\n}\n.bss-slides .bss-show figcaption{\n  z-index: 2;\n  opacity: 1;\n}\n.bss-slides figcaption a{\n  color: #fff;    \n}\n.bss-next, .bss-prev{\n  color: #fff;\n  position: absolute;\n  background: #000;\n  background: rgba(0,0,0, .6);\n  top: 50%;\n  z-index: 4;\n  font-size: 2em;\n  margin-top: -1.2em;\n  opacity: .5;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n.bss-next:hover, .bss-prev:hover{\n  cursor: pointer;\n  opacity: 1;\n}\n.bss-next{\n  right: 0;\n  padding: 10px 5px 15px 10px;\n  border-top-left-radius: 3px;\n  border-bottom-left-radius: 3px;\n}\n.bss-prev{\n  left: 0;\n  padding: 10px 10px 15px 5px;\n  border-top-right-radius: 3px;\n  border-bottom-right-radius: 3px;\n}\n.bss-fullscreen{\n  display: block;\n  width: 24px;\n  height: 24px;    \n  background: rgba(0,0,0,.3) url(http://virtualtranscanada.com/resources/arrows-alt_ffffff_64.png); \n  -webkit-background-size: contain; \n  background-size: contain;\n  position: absolute;\n  top: 5px;\n  left: 5px;   \n  cursor: pointer;    \n  opacity: .3;\n} \n.bss-fullscreen:hover{\n  opacity: .8;   \n}\n:-webkit-full-screen .bss-fullscreen{\n    background: rgba(0,0,0,.4) url(http://virtualtranscanada.com/resources/compress_ffffff_64.png);\n    -webkit-background-size: contain;\n    background-size: contain;\n}\n:-moz-full-screen .bss-fullscreen{\n    background: rgba(0,0,0,.4) url(http://virtualtranscanada.com/resources/compress_ffffff_64.png);\n    background-size: contain;\n}\n:-ms-fullscreen .bss-fullscreen{\n    background: rgba(0,0,0,.4) url(http://virtualtranscanada.com/resources/compress_ffffff_64.png);\n    background-size: contain;\n}\n:full-screen .bss-fullscreen{\n    background: rgba(0,0,0,.4) url(http://virtualtranscanada.com/resources/compress_ffffff_64.png);\n    -webkit-background-size: contain;\n    background-size: contain;\n}\n:-webkit-full-screen .bss-fullscreen{\n    background: rgba(0,0,0,.4) url(http://virtualtranscanada.com/resources/compress_ffffff_64.png);\n    -webkit-background-size: contain;\n    background-size: contain;\n}\n:-moz-full-screen .bss-fullscreen{\n    background: rgba(0,0,0,.4) url(http://virtualtranscanada.com/resources/compress_ffffff_64.png);\n    background-size: contain;\n}\n:-ms-fullscreen .bss-fullscreen{\n    background: rgba(0,0,0,.4) url(http://virtualtranscanada.com/resources/compress_ffffff_64.png);\n    background-size: contain;\n}\n:fullscreen .bss-fullscreen{\n    background: rgba(0,0,0,.4) url(http://virtualtranscanada.com/resources/compress_ffffff_64.png);\n    -webkit-background-size: contain;\n    background-size: contain;\n}\n\n\n\u003c/style\u003e"}]}