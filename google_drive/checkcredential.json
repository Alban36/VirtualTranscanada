{"files":[{"id":"df3958d9-eb9a-4f79-975e-c0e27dcc0bef","name":"Code","type":"server_js","source":"//Description : Function that get spreadsheet data for the specified account\n//parameter : the account name\n// return : the url of the spreadsheet\nfunction GetSpeadsheet(username, password){\n  var accountss \u003d SpreadsheetApp.openByUrl(\u0027https://docs.google.com/spreadsheets/d/1svXwnhaPbj0RMUY2EDADqy17XM9zQ17NWsgp4MPjEmI/edit\u0027);\n  var sheet \u003d accountss.getSheets()[0];\n  var datalength \u003d parseInt(sheet.getRange(\"G2\").getValues()[0]);\n  \n  var data \u003d sheet.getRange(\"A2:E\"+(datalength+1)).getValues();\n  \n  var spreadsheet \u003d \"\";\n  \n  for(var i \u003d 0 ; i \u003c datalength; i++){\n    Logger.log(data[i][0]);\n    if(data[i][0]\u003d\u003dusername)\n    {\n      if(data[i][2]\u003d\u003dpassword)\n      {\n        spreadsheet \u003d data[i][4];\n        break;\n      }\n    }\n  }\n\n  Logger.log(spreadsheet);\n  \n  return spreadsheet;\n}\n\nfunction doGet(request) {\n  var spreadsheetId\u003d\"\";\n  \n  var username \u003d request.parameters.username;\n  var password \u003d request.parameters.password;\n  var callback \u003d request.parameters.callback;\n  \n  Logger.log(request.parameters);\n  \n  spreadsheetId \u003d GetSpeadsheet(username, password);\n  \n  var result;\n  if(spreadsheetId\u003d\u003d\"\")\n  {\n    result \u003d {id: \"none\"} \n  }\n  else\n  {\n    result \u003d {id: spreadsheetId}    \n  }\n  \n  return ContentService.createTextOutput(callback + \"(\" + JSON.stringify(result) + \")\")\n    .setMimeType(ContentService.MimeType.JAVASCRIPT);\n}\n\n"}]}